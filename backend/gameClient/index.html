<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLAY</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet">
	<script src="https://unpkg.com/babylonjs@latest/babylon.js"></script>
	<script src="https://unpkg.com/babylonjs-loaders@latest/babylonjs.loaders.js"></script>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary-gradient: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    --secondary-gradient: linear-gradient(135deg, #ff00ff 0%, #ff0080 100%);
    --accent-gradient: linear-gradient(135deg, #00ffff 0%, #0080ff 100%);
    --dark-bg: #0a0e1a;
    --card-bg: rgba(0, 0, 0, 0.6);
    --settings-bg: rgba(0, 0, 0, 0.58);
    --border-color: rgba(0, 255, 255, 0.401);
    --text-primary: #ffffff;
    --text-secondary: #a8b2d1;
    --hover-shadow: 0 20px 40px rgba(255, 0, 255, 0.2);

    /* Yeni renk deƒüi≈ükenleri */
    --magenta: #ff00ff;
    --cyan: #00ffff;
    --dark-cyan: #008080;
    --dark-magenta: #800080;
    --black-overlay: rgba(0, 0, 0, 0.7);
    --deep-black: #000000;
}

body {
    background: var(--dark-bg);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
}

/* Animated background */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background:
        radial-gradient(circle at 20% 20%, rgba(0, 65, 65, 0.324) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(65, 0, 65, 0.435) 0%, transparent 50%),
        linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
    z-index: -1;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.header {
    text-align: center;
    margin-bottom: 60px;
    position: relative;
}

.title {
    font-size: 3rem;
    font-weight: 800;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 15px;
    letter-spacing: -2px;
    position: relative;
    display: inline-block;
    text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
}

.title::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 3px;
    background: linear-gradient(90deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 2px;
}

.subtitle {
    font-size: 1.1rem;
    color: var(--text-secondary);
    font-weight: 400;
    letter-spacing: 0.5px;
    margin-top: 25px;
}

.game-modes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
}

.game-mode-card {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 35px 30px;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    backdrop-filter: blur(20px);
    position: relative;
    overflow: hidden;
    cursor: pointer;
    box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.game-mode-card::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 20px;
    opacity: 0;
    z-index: -1;
    transition: opacity 0.4s ease;
}

.game-mode-card::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.4) 100%);
    border-radius: 20px;
    z-index: -1;
}

.game-mode-card:hover {
    transform: translateY(-8px);
    box-shadow:
        0 20px 40px rgba(255, 0, 255, 0.15),
        0 0 0 1px rgba(0, 255, 255, 0.2),
        inset 0 0 20px rgba(0, 255, 255, 0.05),
        0 12px 48px rgba(0, 0, 0, 0.6);
    border-color: rgba(0, 255, 255, 0.3);
}

.game-mode-card:hover::before {
    opacity: 1;
}

.game-mode-card.active {
    transform: translateY(-8px);
    border-color: rgba(0, 0, 0, 0.3);
    box-shadow:
        0 20px 40px rgba(255, 0, 255, 0.15),
        0 0 0 1px rgba(0, 255, 255, 0.2),
        inset 0 0 20px rgba(0, 255, 255, 0.05),
        0 12px 48px rgba(0, 0, 0, 0.6);
    background: rgba(0, 0, 0, 0.8);
}

.game-mode-card.active::before {
    opacity: 1;
}

.mode-icon {
    font-size: 3rem;
    margin-bottom: 15px;
    background: linear-gradient(45deg, #ff00ff, #00ffff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.no-select {
	-webkit-user-drag: none;
	user-drag: none;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
}

.mode-title {
    font-size: 1.4rem;
    font-weight: 700;
    margin-bottom: 12px;
    letter-spacing: -0.5px;
    color: var(--text-primary);
}

.game-mode-card.active .mode-title {
    text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
}

.mode-description {
    color: var(--text-secondary);
    font-size: 0.95rem;
    line-height: 1.6;
    font-weight: 400;
}

/* Settings Panel */
.settings-panel {
    background: var(--settings-bg);
    border-radius: 24px;
    padding: 40px;
    margin-top: 30px;
    backdrop-filter: blur(20px);
    border: 1px solid rgba(0, 255, 255, 0.572);
    display: none;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    box-shadow:
        0 20px 60px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.settings-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 24px;
    z-index: -1;
}

.settings-panel.active {
    display: block;
    animation: fadeInUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.settings-panel::-webkit-scrollbar {
    width: 10px;
}

.settings-panel::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
}

.settings-panel::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 10px;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.settings-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 35px;
    text-align: center;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -1px;
    text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
}

.settings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 30px;
}

.setting-group {
    background: rgba(0, 0, 0, 0.2);
    padding: 25px;
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
    box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.setting-group:hover {
    border-color: rgba(0, 255, 255, 0.3);
    background: rgba(0, 0, 0, 0);
    box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.3),
        0 0 20px rgba(0, 255, 255, 0.1);
}

.setting-label {
    display: block;
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 18px;
    color: var(--text-primary);
    letter-spacing: -0.3px;
}

.input-field {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.4);
    color: var(--text-primary);
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.3s ease;
    margin-bottom: 12px;
    font-family: 'Inter', sans-serif;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
}

.input-field:focus {
    outline: none;
    border-color: #00ffff;
    background: rgba(0, 0, 0, 0.6);
    box-shadow:
        0 0 0 4px rgba(0, 255, 255, 0.1),
        0 0 20px rgba(0, 255, 255, 0.2),
        inset 0 2px 8px rgba(0, 0, 0, 0.4);
}

.input-field:hover {
    filter: brightness(1.1);
    border-color: rgba(0, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.5);
}

.input-field::placeholder {
    color: var(--text-secondary);
    font-weight: 400;
}

.radio-group {
    display: flex;
    gap: 12px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    padding: 12px 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    transition: all 0.3s ease;
    background: rgba(0, 0, 0, 0.4);
    position: relative;
    font-weight: 500;
    box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.radio-option:hover {
    border-color: #00ffff;
    background: rgba(0, 0, 0, 0.6);
    transform: translateY(-2px);
    box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(0, 255, 255, 0.1);
}

.radio-option input[type="radio"] {
    display: none;
}

.radio-option:has(input[type="radio"]:checked) {
    border-color: #00ffff;
    background: rgba(0, 0, 0, 0.8);
    box-shadow:
        0 4px 12px rgba(0, 255, 255, 0.2),
        0 8px 32px rgba(0, 0, 0, 0.6);
}

.radio-option:has(input[type="radio"]:checked)::before {
    content: '‚úì';
    position: absolute;
    top: 8px;
    right: 12px;
    color: #00ffff;
    font-weight: 700;
    font-size: 0.9rem;
}

/* Slider Styles */
.slider-container {
	margin: 20px 0;
}

.slider {
	width: 100%;
    height: 8px;
    border-radius: 4px;
    border: 2px solid rgba(0, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.5);
    outline: none;
    -webkit-appearance: none;
    appearance: none;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.4);
}

.slider:hover {
    background: rgba(0, 0, 0, 0.7);
    filter: brightness(1.1);
	border-color: rgba(0, 255, 255, 0.4);
}

.slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    cursor: pointer;
    box-shadow:
        0 2px 8px rgba(0, 255, 255, 0.4),
        0 4px 16px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
}

.slider::-webkit-slider-thumb:hover {
    transform: scale(1.1);
    box-shadow:
        0 4px 16px rgba(0, 255, 255, 0.6),
        0 8px 24px rgba(0, 0, 0, 0.4);
}

.slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    cursor: pointer;
    border: none;
    box-shadow:
        0 2px 8px rgba(0, 255, 255, 0.4),
        0 4px 16px rgba(0, 0, 0, 0.3);
}

.slider-value {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 12px;
    font-size: 0.85rem;
    color: var(--text-secondary);
    font-weight: 500;
}

.current-value {
    color: #00ffff;
    font-weight: 700;
    font-size: 1.1rem;
    background: rgba(0, 0, 0, 0.6);
    padding: 4px 12px;
    border-radius: 8px;
    border: 1px solid rgba(0, 255, 255, 0.2);
    box-shadow:
        0 4px 12px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

/* Toggle Switch */
.toggle-container {
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 12px 0;
}

.toggle-switch {
    position: relative;
    width: 56px;
    height: 28px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.4);
}

.toggle-switch:hover {
    filter: brightness(1.1);
    border-color: rgba(0, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.7);
}

.toggle-switch input {
    display: none;
}

.toggle-slider {
    position: absolute;
    top: 3px;
    left: 3px;
    width: 22px;
    height: 22px;
    background: #ffffff;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

.toggle-switch input:checked + .toggle-slider {
    transform: translateX(28px);
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    box-shadow: 0 2px 8px rgba(0, 255, 255, 0.4);
}

.toggle-switch:has(input:checked) {
    background: rgba(0, 255, 255, 0.3);
    box-shadow:
        0 0 15px rgba(0, 255, 255, 0.3),
        inset 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* AI Difficulty Tooltips */
.difficulty-option {
    position: relative;
}

.difficulty-tooltip {
    position: absolute;
    bottom: calc(100% + 10px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.95);
    color: var(--text-primary);
    padding: 10px 16px;
    border-radius: 10px;
    font-size: 0.85rem;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
    border: 1px solid rgba(0, 255, 255, 0.3);
    backdrop-filter: blur(10px);
    font-weight: 500;
    box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.6),
        0 0 20px rgba(0, 255, 255, 0.2);
}

.difficulty-option:hover .difficulty-tooltip {
    opacity: 1;
    visibility: visible;
}

/* Special AI Settings */
.ai-special-settings {
    display: none;
    margin-top: 30px;
    padding: 30px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 255, 255, 0.2);
    border-radius: 16px;
    position: relative;
    box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.ai-special-settings::before {
    content: '';
    position: absolute;
    top: -1px;
    left: -1px;
    right: -1px;
    bottom: -1px;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 16px;
    opacity: 0.1;
    z-index: -1;
}

.ai-special-settings.active {
    display: block;
    animation: fadeInUp 0.5s ease;
}

.ai-special-settings h3 {
    color: #00ffff !important;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
}

/* Action Buttons */
.action-buttons {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-top: 40px;
    flex-wrap: wrap;
}

.btn {
    padding: 16px 36px;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    min-width: 180px;
    position: relative;
    overflow: hidden;
    font-family: 'Inter', sans-serif;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.2), transparent);
    transition: left 0.3s ease;
}

.btn:hover::before {
    left: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    color: white;
    box-shadow:
        0 4px 16px rgba(255, 0, 255, 0.3),
        0 8px 32px rgba(0, 0, 0, 0.3);
}

.btn-primary:hover {
    transform: translateY(-3px);
    box-shadow:
        0 8px 24px rgba(255, 0, 255, 0.4),
        0 12px 48px rgba(0, 0, 0, 0.4);
}

.btn-secondary {
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.btn-secondary:hover {
    background: rgba(0, 0, 0, 0.8);
    border-color: #00ffff;
    transform: translateY(-3px);
    box-shadow:
        0 8px 24px rgba(0, 255, 255, 0.2),
        0 12px 48px rgba(0, 0, 0, 0.4);
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.5);
    border-color: rgba(255, 255, 255, 0.2);
}

.btn:disabled:hover {
    transform: none;
    box-shadow: none;
}

/* Room Info */
.room-info {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 255, 255, 0.2);
    border-radius: 16px;
    padding: 30px;
    margin-top: 30px;
    text-align: center;
    display: none;
    position: relative;
    overflow: hidden;
    box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.room-info::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
    animation: pulse 3s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

.room-info.active {
    display: block;
    animation: fadeInUp 0.5s ease;
}

.room-id {
    font-size: 2rem;
    font-weight: 800;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 15px;
    letter-spacing: 3px;
    position: relative;
    z-index: 1;
    text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
}

.room-info p {
    color: var(--text-secondary);
    font-weight: 500;
    position: relative;
    z-index: 1;
}

/* Tournament Settings */
.tournament-info {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 255, 255, 0.2);
    border-radius: 12px;
    padding: 20px;
    margin-top: 20px;
    box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.tournament-info small {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-secondary);
    font-weight: 500;
}

/* Join Room Section */
.join-room-section {
    margin-top: 30px;
    padding: 30px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(0, 255, 255, 0.2);
    border-radius: 16px;
    box-shadow:
        0 12px 40px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.input-group {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
}

/* Loading Animation */
.loading {
    display: inline-block;
    width: 24px;
    height: 24px;
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    border-top-color: #00ffff;
    animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Focus visible for accessibility */
.btn:focus-visible,
.input-field:focus-visible,
.radio-option:focus-visible {
    outline: 2px solid #00ffff;
    outline-offset: 3px;
}

/* Smooth scrolling */
html {
    scroll-behavior: smooth;
}

/* Selection color */
::selection {
    background: rgba(0, 255, 255, 0.3);
    color: white;
}

/* Responsive Design */
@media (max-width: 768px) {
    .container {
        padding: 20px 15px;
    }

    .title {
        font-size: 2.5rem;
        letter-spacing: -1px;
    }

    .subtitle {
        font-size: 1rem;
    }

    .game-modes {
        grid-template-columns: 1fr;
        gap: 20px;
    }

    .settings-panel {
        padding: 25px 20px;
    }

    .settings-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }

    .radio-group {
        flex-direction: column;
    }

    .radio-option {
        width: 100%;
        justify-content: center;
    }

    .input-group {
        flex-direction: column;
    }

    .input-group .btn {
        width: 100%;
    }

    .action-buttons {
        flex-direction: column;
    }

    .btn {
        min-width: 100%;
    }

    .room-id {
        font-size: 1.5rem;
    }
}

@media (max-width: 480px) {
    .container {
        padding: 15px 10px;
    }

    .title {
        font-size: 2rem;
    }

    .game-mode-card {
        padding: 25px 20px;
    }

    .mode-icon {
        font-size: 2.5rem;
    }

    .mode-title {
        font-size: 1.2rem;
    }

    .settings-panel {
        padding: 20px 15px;
        margin-top: 20px;
    }

    .settings-title {
        font-size: 1.6rem;
    }

    .setting-group {
        padding: 20px;
    }

    .btn {
        padding: 14px 24px;
        font-size: 0.9rem;
    }

    .room-id {
        font-size: 1.3rem;
        letter-spacing: 2px;
    }
}

/* Ekstra siyah tonlarƒ± ve efektler - daha hafif versiyonlar */
.game-mode-card:hover::after {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.6) 100%);
}

.setting-group::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 16px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.setting-group:hover::before {
    opacity: 1;
}

/* Dark overlay for better contrast - hafifletilmi≈ü */
.settings-panel::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background:
        linear-gradient(45deg, rgba(0, 0, 0, 0.02) 25%, transparent 25%),
        linear-gradient(-45deg, rgba(0, 0, 0, 0.02) 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, rgba(0, 0, 0, 0.02) 75%),
        linear-gradient(-45deg, transparent 75%, rgba(0, 0, 0, 0.02) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
    border-radius: 24px;
    z-index: -1;
    opacity: 0.3;
    pointer-events: none; /* Scroll'u engellemesini √∂nler */
}

/* Enhanced black shadows for depth - hafifletilmi≈ü */
.game-mode-card {
    box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.4),
        0 2px 8px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

.settings-panel {
    box-shadow:
        0 20px 60px rgba(0, 0, 0, 0.3),
        0 8px 32px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* Black gradient overlays for inputs - hafifletilmi≈ü */
.input-field {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.2) 100%),
        rgba(0, 0, 0, 0.4);
    box-shadow:
        inset 0 2px 8px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(0, 0, 0, 0.2),
        0 1px 0 rgba(255, 255, 255, 0.05);
}

.input-field:focus {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.4) 100%),
        rgba(0, 0, 0, 0.6);
}

/* Enhanced radio options with black gradients - hafifletilmi≈ü */
.radio-option {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.2) 100%),
        rgba(0, 0, 0, 0.4);
    box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

.radio-option:hover {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.4) 100%),
        rgba(0, 0, 0, 0.6);
}

.radio-option:has(input[type="radio"]:checked) {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 100%),
        rgba(0, 0, 0, 0.8);
}

/* Black tinted sliders - hafifletilmi≈ü */
.slider {
    background:
        linear-gradient(90deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.3) 100%),
        rgba(0, 0, 0, 0.5);
    box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(0, 0, 0, 0.2),
        0 1px 0 rgba(255, 255, 255, 0.05);
}

/* Enhanced toggle switch with black background - hafifletilmi≈ü */
.toggle-switch {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.3) 100%),
        rgba(0, 0, 0, 0.5);
    box-shadow:
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(0, 0, 0, 0.2),
        0 1px 0 rgba(255, 255, 255, 0.05);
}

/* Current value with enhanced black styling - hafifletilmi≈ü */
.current-value {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.5) 100%),
        rgba(0, 0, 0, 0.6);
    box-shadow:
        0 4px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* Enhanced button styling with black gradients - hafifletilmi≈ü */
.btn-secondary {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(0, 0, 0, 0.4) 100%),
        rgba(0, 0, 0, 0.6);
    box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

.btn-secondary:hover {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 100%),
        rgba(0, 0, 0, 0.8);
}

/* Dark pattern overlay for visual interest - hafifletilmi≈ü */
.container::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image:
        radial-gradient(circle at 1px 1px, rgba(0, 0, 0, 0.05) 1px, transparent 0);
    background-size: 20px 20px;
    z-index: -2;
    opacity: 0.2;
}

/* Enhanced tooltips with black styling - hafifletilmi≈ü */
.difficulty-tooltip {
    background:
        linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.9) 100%),
        rgba(0, 0, 0, 0.95);
    box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(0, 255, 255, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

/* Enhanced scrollbar with black styling - hafifletilmi≈ü */
.settings-panel::-webkit-scrollbar-track {
    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.2);
}

/* Text shadows for better readability on dark backgrounds - hafifletilmi≈ü */
.mode-title,
.settings-title,
.setting-label {
    text-shadow:
        0 1px 2px rgba(0, 0, 0, 0.4),
        0 0 10px rgba(0, 0, 0, 0.2);
}

/* Enhanced focus states with black accents - hafifletilmi≈ü */
.input-field:focus,
.radio-option:focus-visible,
.btn:focus-visible {
    box-shadow:
        0 0 0 4px rgba(0, 255, 255, 0.1),
        0 0 20px rgba(0, 255, 255, 0.2),
        inset 0 0 10px rgba(0, 0, 0, 0.2);
}

/* √ñzel ayarlar i√ßin magenta/cyan gradient title */
.settings-title {
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ff00ff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% 100%;
    animation: gradientShift 3s ease-in-out infinite;
}

@keyframes gradientShift {
    0%, 100% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
}

/* Hafif glow efekti title i√ßin */
.settings-title::before {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: blur(10px);
    opacity: 0.3;
    z-index: -1;
}

.game-page {
    display: block;
}

.game-page.hidden {
    display: none;
}

.game-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    display: none;
    touch-action: none;
    z-index: 9999;
}

.game-container canvas {
    width: 100% !important;
    height: 100% !important;
    display: block;
}

.game-page.hidden .game-container {
    display: block;
}


.waiting-room {
    display: none;
    text-align: center;
    padding: 50px;
}

.waiting-room.active {
    display: block;
    animation: fadeInUp 0.5s ease;
}

/* Back Arrow Button */
.back-arrow {
	width: 30px;
    height: 30px;
    padding: 5px;
    position: fixed;
    top: 30px;
    left: 20px;
    width: 50px;
    height: 50px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    z-index: 1000;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
	background: none;
}

.back-arrow.active {
    display: flex;
    animation: slideInLeft 0.5s ease;
}

.back-arrow:hover {
    transform: translateX(-5px) scale(1.05);
	filter: drop-shadow(0 0 10px #008080) drop-shadow(0 0 20px #008080);
}

.back-arrow:active {
    transform: translateX(-5px) scale(0.95);
}

.back-arrow svg {
	fill: #00ffff;
	width: 100%; /* SVG'nin buton boyutuna uymasƒ± i√ßin %100 */
    height: 100%; /* SVG'nin buton boyutuna uymasƒ± i√ßin %100 */
}

@keyframes slideInLeft {
    from {
        opacity: 0;
        transform: translateX(-50px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Responsive */
@media (max-width: 768px) {
    .back-arrow {
        width: 45px;
        height: 45px;
        font-size: 20px;
        top: 15px;
        left: 15px;
    }
}

/* Scrollbar for participants list */
.participants-list::-webkit-scrollbar {
	width: 8px;
}

.participants-list::-webkit-scrollbar-track {
	background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
}

.participants-list::-webkit-scrollbar-thumb {
	background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 4px;
}

/* Waiting Room Styles */
.waiting-room {
    display: none;
    min-height: 100vh;
    padding: 40px 20px;
    background: none;
}

.waiting-room.active {
    display: block;
    animation: fadeInUp 0.5s ease;
}

.room-container {
    max-width: 1000px;
    margin: 0 auto;
}

/* Room Header */
.room-header {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    backdrop-filter: blur(10px);
}

.room-header h2 {
    text-align: center;
    font-size: 32px;
    margin-bottom: 30px;
    background: linear-gradient(135deg, #00ffff, #ff00ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.room-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.room-info-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
}

.room-info-card:hover {
    transform: translateY(-5px);
    border-color: rgba(0, 255, 255, 0.3);
    box-shadow: 0 8px 24px rgba(0, 255, 255, 0.2);
}

.info-label {
    display: block;
    font-size: 12px;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 8px;
}

.info-value {
    display: block;
    font-size: 20px;
    font-weight: bold;
    color: #00ffff;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

/* Participants Section */
.participants-section {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 10px;
    margin-bottom: 10px;
    backdrop-filter: blur(10px);
}

.participants-section h3 {
    font-size: 24px;
    margin-bottom: 20px;
    color: #fff;
}

.participants-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 5px;
    max-height: 400px;
    overflow-y: auto;
	overflow-x: auto;
    padding-right: 10px;
}

.participant-card {
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid;
    border-radius: 12px;
    padding: 15px 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    position: relative;
    overflow: hidden;
}

.participant-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.1;
}

.participant-card:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

.participant-icon svg {
    display: block;
    margin: 0 auto;
    filter: drop-shadow(0 0 4px rgba(0, 255, 255, 0.5));
}

.participant-name {
    font-size: 16px;
    font-weight: 600;
    color: #fff;
    z-index: 1;
}

/* Room Actions */
.room-actions {
    display: flex;
    justify-content: center;
    gap: 20px;
}

.btn-large {
    padding: 18px 50px;
    font-size: 18px;
    font-weight: bold;
    min-width: 250px;
}

/* Scrollbar for participants grid */
.participants-grid::-webkit-scrollbar {
    width: 8px;
}

.participants-grid::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
}

.participants-grid::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #ff00ff 0%, #00ffff 100%);
    border-radius: 4px;
}

/* Responsive */
@media (max-width: 768px) {
    .room-info-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .participants-grid {
        grid-template-columns: 1fr;
    }

    .btn-large {
        min-width: 100%;
    }
}

@media (max-width: 480px) {
    .room-info-grid {
        grid-template-columns: 1fr;
    }
}

.fast-game-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 30px 0;
}

/* Fast Game Mode Card - Meteor Theme */
.fast-game-mode-card {
    background: linear-gradient(135deg, #d10101d7 0%, #f97800d2 100%);
    border-radius: 16px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 16px rgba(255, 8, 68, 0.4);
	margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
    min-height: 160px;
    max-width: 180px;
}

.fast-game-mode-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 16px 32px rgba(255, 8, 68, 0.6);
    background: linear-gradient(135deg, #ff0844 0%, #ff6b6b 50%, #ff9999 100%);
}

.fast-game-mode-card:active {
    transform: translateY(-4px) scale(0.98);
}

/* Fast Label (hidden but kept for structure) */
.fast-label {
    display: none;
}

/* Fast Mode Icon */
.fast-mode-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #ff6b6b 0%, #b52424 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    position: relative;
    box-shadow: 0 4px 12px rgba(255, 8, 68, 0.4),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
}

/* Pulsing Glow Ring */
.fast-mode-icon::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 3px solid rgba(255, 107, 107, 0.6);
}

.fast-game-mode-card:hover .fast-mode-icon::after {
    border-color: rgba(255, 255, 255, 0.8);
}

.fast-mode-icon svg {
    width: 48px;
    height: 48px;
    fill: #ffffff;
    filter: drop-shadow(0 4px 8px rgba(255, 8, 8, 0.5));
    transition: all 0.3s ease;
}

/* Fast Mode Title */
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
.fast-mode-title {
	font-family: "Audiowide", sans-serif;
    font-size: 20px;
    font-weight: 700;
    color: #ffffff;
    text-align: center;
    text-shadow: 0 2px 8px rgba(255, 0, 0, 0.6);
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
}

/* Loading Screen */
.loading-screen {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 9999;
    background: var(--dark-bg);
}

.loading-screen::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background:
        radial-gradient(circle at 20% 20%, rgba(0, 65, 65, 0.324) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(65, 0, 65, 0.435) 0%, transparent 50%),
        linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
    z-index: -1;
}

.loading-screen.active {
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
}

.loading-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
}

.loading-spinner {
    width: 120px;
    height: 120px;
    position: relative;
}

.loading-spinner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
    border: 4px solid rgba(255, 255, 255, 0.1);
    border-top-color: #ff08a0;
    border-right-color: #6bfff5;
    animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
    box-shadow:
        0 0 20px rgba(255, 8, 201, 0.3),
        inset 0 0 20px rgba(8, 239, 255, 0.1);
}

.loading-spinner::after {
    content: '';
    position: absolute;
    top: 10px;
    left: 10px;
    right: 10px;
    bottom: 10px;
    border-radius: 50%;
    border: 3px solid rgba(255, 255, 255, 0.05);
    border-bottom-color: #00ffff;
    border-left-color: #00ffff;
    animation: spin 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite reverse;
}

.loading-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #00fbffa6 0%, #a5027a 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
        0 4px 12px rgba(255, 0, 0, 0.4),
        inset 0 2px 4px rgba(255, 255, 255, 0.3);
    animation: pulse 2s ease-in-out infinite;
}

.loading-icon svg {
    width: 30px;
    height: 30px;
    fill: #ffffff;
    filter: drop-shadow(0 2px 4px rgba(169, 0, 0, 0.5));
}

.loading-text {
    font-size: 24px;
    font-weight: 700;
    background: linear-gradient(135deg, #00f7ffd7 0%, #ff00c8 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 0 20px rgba(255, 8, 68, 0.3);
    animation: textPulse 2s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

@keyframes pulse {
    0%, 100% {
        transform: translate(-50%, -50%) scale(1);
        box-shadow:
            0 4px 12px rgba(255, 8, 68, 0.4),
            inset 0 2px 4px rgba(255, 255, 255, 0.3);
    }
    50% {
        transform: translate(-50%, -50%) scale(1.1);
        box-shadow:
            0 6px 20px rgba(255, 8, 68, 0.6),
            inset 0 2px 6px rgba(255, 255, 255, 0.4);
    }
}

@keyframes textPulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.05);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* Back Arrow in Loading Screen */
.loading-screen .back-arrow {
    position: fixed;
    top: 30px;
    left: 30px;
    display: flex;
}

/* Responsive Design */
@media (max-width: 768px) {
    .fast-game-mode-card {
        padding: 14px;
        min-height: 120px;
        max-width: 140px;
    }

    .fast-mode-icon {
        width: 52px;
        height: 52px;
    }

    .fast-mode-icon svg {
        width: 32px;
        height: 32px;
    }

    .fast-mode-title {
        font-size: 16px;
    }

    .loading-spinner {
        width: 100px;
        height: 100px;
    }

    .loading-icon {
        width: 40px;
        height: 40px;
    }

    .loading-icon svg {
        width: 24px;
        height: 24px;
    }

    .loading-text {
        font-size: 20px;
    }

    .loading-subtext {
        font-size: 12px;
    }
}

@media (max-width: 480px) {
    .fast-game-mode-card {
        padding: 12px;
        min-height: 110px;
        gap: 10px;
        max-width: 130px;
    }

    .fast-mode-icon {
        width: 48px;
        height: 48px;
    }

    .fast-mode-icon svg {
        width: 28px;
        height: 28px;
    }

    .fast-mode-title {
        font-size: 15px;
    }

    .loading-spinner {
        width: 80px;
        height: 80px;
    }

    .loading-icon {
        width: 35px;
        height: 35px;
    }

    .loading-icon svg {
        width: 20px;
        height: 20px;
    }

    .loading-text {
        font-size: 18px;
    }

    .loading-screen .back-arrow {
        top: 20px;
        left: 20px;
        width: 45px;
        height: 45px;
    }
}

/* Match Pairs Grid */
.match-pairs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

/* Match Pair Card */
.match-pair-card {
    background: rgba(0, 0, 0, 0.3);
    border: 2px solid;
    border-radius: 16px;
    padding: 20px;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
}

.match-pair-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.1;
    z-index: 0;
}

.match-pair-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4);
}

/* Match Header */
.match-header {
    text-align: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    z-index: 1;
}

.match-number {
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.8;
}

/* Match Players */
.match-players {
    display: flex;
    flex-direction: column;
    gap: 10px;
    position: relative;
    z-index: 1;
}

.match-player {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.match-player:hover {
    background: rgba(0, 0, 0, 0.5);
    transform: translateX(5px);
}

.match-player-icon {
    font-size: 20px;
}

.match-player-icon svg {
    width: 24px;
    height: 24px;
    filter: drop-shadow(0 0 4px currentColor);
}

.match-player-name {
    flex: 1;
    font-size: 15px;
    font-weight: 600;
    color: #fff;
}

/* VS Divider */
.vs-divider {
    text-align: center;
    margin: 5px 0;
    position: relative;
    z-index: 1;
}

.vs-text {
    display: inline-block;
    padding: 5px 15px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 2px;
    color: #fff;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

/* Matched State Animation */
@keyframes matchedPulse {
    0%, 100% {
        box-shadow: 0 0 20px currentColor;
    }
    50% {
        box-shadow: 0 0 40px currentColor;
    }
}

.match-pair-card.matched {
    animation: matchedPulse 2s ease-in-out infinite;
}

/* Participant card matched state */
.participant-card.matched {
    animation: matchedPulse 2s ease-in-out infinite;
}

/* Canvas Overlay Stilleri */
.canvas-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 10;
}

.canvas-overlay > * {
    pointer-events: auto;
}

/* Canvas Butonlarƒ± */
.canvas-btn {
    background: var(--black-overlay);
    border: 2px solid var(--border-color);
    color: var(--text-primary);
    padding: 10px;
    border-radius: 8px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    min-width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.canvas-btn:hover {
    background: var(--primary-gradient);
    border-color: var(--magenta);
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.exit-btn:hover {
    background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
}

/* Responsive tasarƒ±m */
@media (max-width: 768px) {
    .canvas-btn {
        min-width: 40px;
        height: 40px;
        font-size: 1rem;
    }
}

</style>
</head>
<body>
	<button class="back-arrow" id="back-arrow" ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576C461.4 576 576 461.4 576 320zM188.7 308.7L292.7 204.7C297.3 200.1 304.2 198.8 310.1 201.2C316 203.6 320 209.5 320 216L320 272L416 272C433.7 272 448 286.3 448 304L448 336C448 353.7 433.7 368 416 368L320 368L320 424C320 430.5 316.1 436.3 310.1 438.8C304.1 441.3 297.2 439.9 292.7 435.3L188.7 331.3C182.5 325.1 182.5 314.9 188.7 308.7z"/></svg></button>
    <div class="container">

		<!-- Tournament Waiting Room -->
		<div class="waiting-room" id="waiting-room">
		    <div class="room-container">
		        <!-- Room Header -->
		        <div class="room-header">
		            <h2>üèÜ Tournament Room</h2>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">ROOM CODE</span>
		                    <span class="info-value" id="room-code-display">TOUR-XXXXX</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">PLAYERS</span>
		                    <span class="info-value" id="players-count">0/8</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">FORMAT</span>
		                    <span class="info-value">Single Elimination</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">STATUS</span>
		                    <span class="info-value" id="tournament-status-display">Waiting</span>
		                </div>
		            </div>
		        </div>

		        <!-- Participants Section -->
		        <div class="participants-section">
		            <h3>üë• Participants</h3>
		            <div class="participants-grid" id="participants-grid">
		                <!-- Participants will be added dynamically -->
		            </div>
		        </div>

		        <!-- Match Pairs Section (Hidden until matching) -->
		        <div class="participants-section" id="match-pairs-section" style="display: none;">
		            <h3>‚öîÔ∏è Match Pairs - Round 1</h3>
		            <div id="match-pairs-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
		                <!-- Match pairs will be displayed here -->
		            </div>
		        </div>

		        <!-- Action Buttons -->
		        <div class="room-actions">
		            <button class="btn btn-secondary btn-large" id="waiting-players-btn" disabled>
		                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M160 64C142.3 64 128 78.3 128 96C128 113.7 142.3 128 160 128L160 139C160 181.4 176.9 222.1 206.9 252.1L274.8 320L206.9 387.9C176.9 417.9 160 458.6 160 501L160 512C142.3 512 128 526.3 128 544C128 561.7 142.3 576 160 576L480 576C497.7 576 512 561.7 512 544C512 526.3 497.7 512 480 512L480 501C480 458.6 463.1 417.9 433.1 387.9L365.2 320L433.1 252.1C463.1 222.1 480 181.4 480 139L480 128C497.7 128 512 113.7 512 96C512 78.3 497.7 64 480 64L160 64zM416 501L416 512L224 512L224 501C224 475.5 234.1 451.1 252.1 433.1L320 365.2L387.9 433.1C405.9 451.1 416 475.5 416 501z"/></svg>
						<span>Oyuncular Bekleniyor...</span>
		            </button>
		            <button class="btn btn-primary btn-large" id="match-players-btn" style="display: none;">
		                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M205.4 66.3C167 56 127.5 78.8 117.3 117.2L66.5 306.7C56.2 345.1 79 384.6 117.4 394.9L306.9 445.7C345.3 456 384.8 433.2 395.1 394.8L445.9 205.3C456.2 166.9 433.4 127.4 395 117.1L205.4 66.3zM228.4 272C222.3 262.1 222.1 249.6 227.8 239.5C233.5 229.4 244.3 223.2 256 223.3C267.6 223.4 278.2 229.8 283.8 240C289.9 249.9 290.1 262.4 284.4 272.5C278.7 282.6 267.9 288.8 256.2 288.7C244.6 288.6 234 282.2 228.4 272zM143.2 284.3C153.1 278.2 165.6 278 175.7 283.7C185.8 289.4 192 300.2 191.9 311.9C191.8 323.5 185.4 334.1 175.2 339.7C165.3 345.8 152.8 346 142.7 340.3C132.6 334.6 126.4 323.8 126.5 312.1C126.6 300.5 133 289.9 143.2 284.3zM328.2 380.7C318.3 386.8 305.8 387 295.7 381.3C285.6 375.6 279.4 364.8 279.5 353.1C279.6 341.5 286 330.9 296.2 325.3C306.1 319.2 318.6 319 328.7 324.7C338.8 330.4 345 341.2 344.9 352.9C344.8 364.5 338.4 375.1 328.2 380.7zM337.2 172.3C347.1 166.2 359.6 166 369.7 171.7C379.8 177.4 386 188.2 385.9 199.9C385.8 211.5 379.4 222.1 369.2 227.7C359.3 233.8 346.8 234 336.7 228.3C326.6 222.6 320.4 211.8 320.5 200.1C320.6 188.5 327 177.9 337.2 172.3zM216.2 186.7C206.3 192.8 193.8 193 183.7 187.3C173.6 181.6 167.4 170.8 167.5 159.1C167.6 147.5 174 136.9 184.2 131.3C194.1 125.2 206.6 125 216.7 130.7C226.8 136.4 233 147.2 232.9 158.9C232.8 170.5 226.4 181.1 216.2 186.7zM482 256L441.4 407.2C424.2 471.2 358.4 509.2 294.4 492.1L256.1 481.8L256.1 512C256.1 547.3 284.8 576 320.1 576L512.1 576C547.4 576 576.1 547.3 576.1 512L576.1 320C576.1 284.7 547.4 256 512.1 256L482 256z"/></svg>
						<span>E≈üle≈ütirmeleri Yap</span>
		            </button>
		            <button class="btn btn-primary btn-large" id="start-tournament-btn" style="display: none;">
		                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M192 384L88.5 384C63.6 384 48.3 356.9 61.1 335.5L114 247.3C122.7 232.8 138.3 224 155.2 224L250.2 224C326.3 95.1 439.8 88.6 515.7 99.7C528.5 101.6 538.5 111.6 540.3 124.3C551.4 200.2 544.9 313.7 416 389.8L416 484.8C416 501.7 407.2 517.3 392.7 526L304.5 578.9C283.2 591.7 256 576.3 256 551.5L256 448C256 412.7 227.3 384 192 384L191.9 384zM464 224C464 197.5 442.5 176 416 176C389.5 176 368 197.5 368 224C368 250.5 389.5 272 416 272C442.5 272 464 250.5 464 224z"/></svg>
						<span>Turnuvayƒ± Ba≈ülat</span>
		            </button>
		        </div>
		    </div>
		</div>

        <!-- Round Waiting Room (Tournament) - Yeni Ekleme -->
        <div class="waiting-room" id="round-waiting-room">
            <div class="room-container">
                <!-- Round Header -->
                <div class="room-header">
                    <h2>üèÜ Round Completed!</h2>
                    <div class="room-info-grid">
                        <div class="room-info-card">
                            <span class="info-label">CURRENT ROUND</span>
                            <span class="info-value" id="round-current-display">1</span>
                        </div>
                        <div class="room-info-card">
                            <span class="info-label">TOTAL ROUNDS</span>
                            <span class="info-value" id="round-total-display">3</span>
                        </div>
                        <div class="room-info-card">
                            <span class="info-label">REMAINING PLAYERS</span>
                            <span class="info-value" id="round-remaining-players">4</span>
                        </div>
                        <div class="room-info-card">
                            <span class="info-label">NEXT ROUND</span>
                            <span class="info-value" id="round-next-display">Round 2</span>
                        </div>
                    </div>
                </div>

                <!-- Winners Section -->
                <div class="participants-section">
                    <h3>üéâ Round Winners - Advancing to Next Round</h3>
                    <div class="participants-grid" id="round-winners-grid">
                        <!-- Winners will be added dynamically -->
                    </div>
                </div>

                <!-- Next Round Match Pairs -->
                <div class="participants-section" id="next-round-pairs-section" style="display: none;">
                    <h3>‚öîÔ∏è Next Round Matches</h3>
                    <div id="next-round-pairs-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                        <!-- Next round pairs will be displayed here -->
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="room-actions">
                    <button class="btn btn-secondary btn-large" id="round-waiting-btn" disabled>
                        ‚è≥ Waiting for Host...
                    </button>
                    <button class="btn btn-primary btn-large" id="next-round-btn" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="20" height="20" fill="white" style="margin-right: 8px;">
                            <path d="M544 160C544 124.7 515.3 96 480 96L160 96C124.7 96 96 124.7 96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160zM416 320C416 326.7 413.2 333 408.3 337.6L296.3 441.6C289.3 448.1 279.1 449.8 270.4 446C261.7 442.2 256 433.5 256 424L256 216C256 206.5 261.7 197.8 270.4 194C279.1 190.2 289.3 191.9 296.3 198.4L408.3 302.4C413.2 306.9 416 313.3 416 320z"/>
                        </svg>
                        <span>Start Next Round</span>
                    </button>
                    <button class="btn btn-primary btn-large" id="final-round-btn" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="20" height="20" fill="white" style="margin-right: 8px;">
                            <path d="M400 0L176 0c-26.5 0-48.1 21.8-47.1 48.2c.2 5.3 .4 10.6 .7 15.8L24 64C10.7 64 0 74.7 0 88c0 92.6 33.5 157 78.5 200.7c44.3 43.1 98.3 64.8 138.1 75.8c23.4 6.5 39.4 26 39.4 45.6c0 20.9-17 37.9-37.9 37.9L192 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-26.1 0C337 448 320 431 320 410.1c0-19.6 15.9-39.2 39.4-45.6c39.9-11 93.9-32.7 138.2-75.8C542.5 245 576 180.6 576 88c0-13.3-10.7-24-24-24L446.4 64c.3-5.2 .5-10.4 .7-15.8C448.1 21.8 426.5 0 400 0zM48.9 112l84.4 0c9.1 90.1 29.2 150.3 51.9 190.6c-24.9-11-50.8-26.5-73.2-48.3c-32-31.1-58-76-63-142.3zM464.1 254.3c-22.4 21.8-48.3 37.3-73.2 48.3c22.7-40.3 42.8-100.5 51.9-190.6l84.4 0c-5.1 66.3-31.1 111.2-63 142.3z"/>
                        </svg>
                        <span>Start Final Round</span>
                    </button>
                </div>
            </div>
        </div>

		<!-- Custom Game Waiting Room -->
		<div class="waiting-room" id="custom-waiting-room">
		    <div class="room-container">
		        <!-- Room Header -->
		        <div class="room-header">
		            <h2>üèì Game Room</h2>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">ROOM CODE</span>
		                    <span class="info-value" id="custom-room-code-display">GAME-XXXXX</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">PLAYERS</span>
		                    <span class="info-value" id="custom-players-count">1/2</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">GAME TYPE</span>
		                    <span class="info-value" id="custom-game-type-display">1 vs 1</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">STATUS</span>
		                    <span class="info-value" id="custom-status-display">Waiting</span>
		                </div>
		            </div>
		        </div>

		        <!-- Participants Section -->
		        <div class="participants-section">
		            <h3>üë• Players</h3>
		            <div class="participants-grid" id="custom-participants-grid">
		                <!-- Participants will be added dynamically -->
		            </div>
		        </div>

		        <!-- Game Settings Display -->
		        <div class="participants-section">
		            <h3>‚öôÔ∏è Game Settings</h3>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">PADDLE HEIGHT</span>
		                    <span class="info-value" id="custom-paddle-display">100px</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">BALL RADIUS</span>
		                    <span class="info-value" id="custom-ball-display">10px</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">CORNER BOOST</span>
		                    <span class="info-value" id="custom-corner-display">1.0x</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">WINNING SCORE</span>
		                    <span class="info-value" id="custom-score-display">11</span>
		                </div>
		            </div>
		        </div>

		        <!-- Action Buttons -->
				<div class="room-actions">
				    <button class="btn btn-secondary btn-large" id="custom-waiting-players-btn" disabled>
				        ‚è≥ Kullanƒ±cƒ±lar Bekleniyor...
				    </button>
				    <button class="btn btn-primary btn-large" id="custom-start-game-btn" style="display: none;">
				        üöÄ Oyunu Ba≈ülat
				    </button>
				</div>
		    </div>
		</div>

		<!-- AI Game Waiting Room -->
		<div class="waiting-room" id="ai-waiting-room">
		    <div class="room-container">
		        <!-- Room Header -->
		        <div class="room-header">
		            <h2>ü§ñ AI Game Room</h2>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">GAME MODE</span>
		                    <span class="info-value">1 vs AI</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">DIFFICULTY</span>
		                    <span class="info-value" id="ai-difficulty-display">Medium</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">AI TYPE</span>
		                    <span class="info-value" id="ai-type-display">Standard</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">STATUS</span>
		                    <span class="info-value">Ready</span>
		                </div>
		            </div>
		        </div>

		        <!-- Players Section -->
		        <div class="participants-section">
		            <h3>üë• Players</h3>
		            <div class="participants-grid" id="ai-participants-grid">
		                <!-- Will Not You vs AI -->
		            </div>
		        </div>

		        <!-- Game Settings Display -->
		        <div class="participants-section">
		            <h3>‚öôÔ∏è Game Settings</h3>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">PADDLE HEIGHT</span>
		                    <span class="info-value" id="ai-paddle-display">100px</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">BALL RADIUS</span>
		                    <span class="info-value" id="ai-ball-display">10px</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">CORNER BOOST</span>
		                    <span class="info-value" id="ai-corner-display">1.0x</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">WINNING SCORE</span>
		                    <span class="info-value" id="ai-score-display">11</span>
		                </div>
		            </div>
		        </div>

		        <!-- AI Special Settings Display (if custom) -->
		        <div class="participants-section" id="ai-custom-settings-display" style="display: none;">
		            <h3>ü§ñ Custom AI Settings</h3>
		            <div class="room-info-grid">
		                <div class="room-info-card">
		                    <span class="info-label">REACTION SPEED</span>
		                    <span class="info-value" id="ai-reaction-display">5</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">PREDICTION</span>
		                    <span class="info-value" id="ai-prediction-display">5</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">ACCURACY</span>
		                    <span class="info-value" id="ai-accuracy-display">5</span>
		                </div>
		                <div class="room-info-card">
		                    <span class="info-label">LEARNING SPEED</span>
		                    <span class="info-value" id="ai-learning-display">5</span>
		                </div>
		            </div>
		        </div>

		        <!-- Action Buttons -->
		        <div class="room-actions">
		            <button class="btn btn-primary btn-large" id="ai-start-game-btn">
		                üöÄ Start AI Game
		            </button>
		        </div>
		    </div>
		</div>

		<!-- Loading Screen -->
		<div class="loading-screen" id="loading-screen">
		    <button class="back-arrow" id="loading-back-arrow">
		        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576C461.4 576 576 461.4 576 320zM188.7 308.7L292.7 204.7C297.3 200.1 304.2 198.8 310.1 201.2C316 203.6 320 209.5 320 216L320 272L416 272C433.7 272 448 286.3 448 304L448 336C448 353.7 433.7 368 416 368L320 368L320 424C320 430.5 316.1 436.3 310.1 438.8C304.1 441.3 297.2 439.9 292.7 435.3L188.7 331.3C182.5 325.1 182.5 314.9 188.7 308.7z"/></svg>
		    </button>
		    <div class="loading-content">
		        <div class="loading-spinner">
		            <div class="loading-icon">
		                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
		                    <path d="M557.7 64.9L363.5 139.6L365.8 110.3C366.8 97.5 353 88.8 341.8 95.2L165.3 197.4C102.6 233.7 64 300.6 64 373C64 485.1 154.9 576 267 576C339.4 576 406.3 537.4 442.6 474.7L544.8 298.3C551.3 287.2 542.6 273.3 529.7 274.3L500.4 276.6L575.1 82.4C575.7 80.9 576 79.2 576 77.6C576 70.1 570 64.1 562.5 64.1C560.8 64.1 559.2 64.4 557.7 65zM256 256C326.7 256 384 313.3 384 384C384 454.7 326.7 512 256 512C185.3 512 128 454.7 128 384C128 313.3 185.3 256 256 256zM256 352C256 334.3 241.7 320 224 320C206.3 320 192 334.3 192 352C192 369.7 206.3 384 224 384C241.7 384 256 369.7 256 352zM272 448C280.8 448 288 440.8 288 432C288 423.2 280.8 416 272 416C263.2 416 256 423.2 256 432C256 440.8 263.2 448 272 448z"/>
		                </svg>
		            </div>
		        </div>
		        <div class="loading-text">Loading...</div>
		    </div>
		</div>

		<div class="game-page" id="game-page">
	        <div class="header">
        	    <h1 class="title">PLAY MODE</h1>
        	    <p class="subtitle">Oyun Modunu Se√ßin ve Ayarlarƒ±nƒ±zƒ± Yapƒ±n</p>
        	</div>

	        <div class="game-modes">
	            <div class="game-mode-card" id="custom-mode">
	                <div class="mode-icon no-select">üèì</div>
	                <h3 class="mode-title">Oyun</h3>
	                <p class="mode-description">Kendi kurallarƒ±nla √∂zel oyun modlarƒ± olu≈ütur. T√ºm ayarlarƒ± √∂zelle≈ütir.</p>
	            </div>

	            <div class="game-mode-card" id="tournament-mode">
	                <div class="mode-icon no-select">üèÜ</div>
	                <h3 class="mode-title">Turnuva</h3>
	                <p class="mode-description">Turnuva olu≈ütur veya katƒ±l. Birden fazla oyuncuyla rekabet et.</p>
	            </div>

	            <div class="game-mode-card" id="ai-mode">
	                <div class="mode-icon no-select">ü§ñ</div>
	                <h3 class="mode-title">AI ile Oyun</h3>
	                <p class="mode-description">Yapay zeka ile farklƒ± zorluk seviyelerinde oyna. AI'ƒ± √∂zelle≈ütir.</p>
	            </div>
	        </div>

	        <!-- Custom Game Settings -->
	        <div class="settings-panel" id="custom-settings">
	            <h2 class="settings-title">Oyun Ayarlarƒ±</h2>

	            <div class="settings-grid">
	                <div class="setting-group">
	                    <label class="setting-label">Oyun Tipi</label>
	                    <div class="radio-group">
	                        <label class="radio-option">
	                            <input type="radio" name="custom-game-type" value="1v1" checked>
	                            <span class="radio-label">1 vs 1</span>
	                        </label>
	                        <label class="radio-option">
	                            <input type="radio" name="custom-game-type" value="2v2">
	                            <span class="radio-label">2 vs 2</span>
	                        </label>
	                        <label class="radio-option">
	                            <input type="radio" name="custom-game-type" value="co-op">
	                            <span class="radio-label">local</span>
	                        </label>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Paddle Y√ºksekliƒüi</label>
	                    <div class="slider-container">
	                        <input type="range" min="50" max="200" value="100" class="slider" id="paddle-height">
	                        <div class="slider-value">
	                            <span>Min: 50px</span>
	                            <span class="current-value" id="paddle-height-value">100px</span>
	                            <span>Max: 200px</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Top Yarƒ± √áapƒ±</label>
	                    <div class="slider-container">
	                        <input type="range" min="5" max="25" value="10" class="slider" id="ball-radius">
	                        <div class="slider-value">
	                            <span>Min: 5px</span>
	                            <span class="current-value" id="ball-radius-value">10px</span>
	                            <span>Max: 25px</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">K√∂≈üe √áarpma Hƒ±zlanmasƒ±</label>
	                    <div class="slider-container">
	                        <input type="range" min="0" max="5" value="1" step="0.1" class="slider" id="corner-boost">
	                        <div class="slider-value">
	                            <span>Yok</span>
	                            <span class="current-value" id="corner-boost-value">1.0x</span>
	                            <span>5x</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Biti≈ü Skoru</label>
	                    <input type="number" min="1" max="50" value="11" class="input-field" id="winning-score" placeholder="Kazanmak i√ßin gereken skor">
	                </div>

					<div class="setting-group fast-game-mode-card" id="fast-game-mode">
						<label class="fast-label"></label>
						<div class="fast-mode-icon no-select"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M557.7 64.9L363.5 139.6L365.8 110.3C366.8 97.5 353 88.8 341.8 95.2L165.3 197.4C102.6 233.7 64 300.6 64 373C64 485.1 154.9 576 267 576C339.4 576 406.3 537.4 442.6 474.7L544.8 298.3C551.3 287.2 542.6 273.3 529.7 274.3L500.4 276.6L575.1 82.4C575.7 80.9 576 79.2 576 77.6C576 70.1 570 64.1 562.5 64.1C560.8 64.1 559.2 64.4 557.7 65zM256 256C326.7 256 384 313.3 384 384C384 454.7 326.7 512 256 512C185.3 512 128 454.7 128 384C128 313.3 185.3 256 256 256zM256 352C256 334.3 241.7 320 224 320C206.3 320 192 334.3 192 352C192 369.7 206.3 384 224 384C241.7 384 256 369.7 256 352zM272 448C280.8 448 288 440.8 288 432C288 423.2 280.8 416 272 416C263.2 416 256 423.2 256 432C256 440.8 263.2 448 272 448z"/></svg></div>
						<span class="fast-mode-title">Hƒ±zlƒ± Oyun</span>
					</div>
				</div>
	            <div class="join-room-section">
	                <label class="setting-label">Mevcut Odaya Katƒ±l</label>
	                <div class="input-group">
	                    <input type="text" class="input-field" id="custom-room-code" placeholder="Oda kodunu girin..." maxlength="6">
	                    <button class="btn btn-secondary" id="custom-join-btn">Odaya Katƒ±l</button>
	                </div>
	            </div>

	            <div class="action-buttons">
	                <button class="btn btn-primary" id="custom-create-btn">Oda Olu≈ütur</button>
	            </div>
	        </div>

	        <!-- Tournament Settings -->
	        <div class="settings-panel" id="tournament-settings">
	            <h2 class="settings-title">Turnuva Ayarlarƒ±</h2>

	            <div class="settings-grid">
	                <div class="setting-group">
	                    <label class="setting-label">Turnuva ƒ∞smi</label>
	                    <input type="text" class="input-field" id="tournament-name" placeholder="Turnuva ismini girin..." maxlength="50">
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Ki≈üi Sayƒ±sƒ±</label>
	                    <div class="radio-group">
	                        <label class="radio-option">
	                            <input type="radio" name="tournament-size" value="4" checked>
	                            <span class="radio-label">4 Ki≈üi                        </span>
	                        </label>
	                        <label class="radio-option">
	                            <input type="radio" name="tournament-size" value="8">
	                            <span class="radio-label">8 Ki≈üi</span>
	                        </label>
	                        <label class="radio-option">
	                            <input type="radio" name="tournament-size" value="16">
	                            <span class="radio-label">16 Ki≈üi</span>
	                        </label>
	                        <label class="radio-option">
	                            <input type="radio" name="tournament-size" value="custom">
	                            <span class="radio-label">√ñzel</span>
	                        </label>
	                    </div>
	                    <input type="number" min="4" class="input-field" id="custom-tournament-size" placeholder="√ñzel ki≈üi sayƒ±sƒ±" style="display: none;">
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Oyuncu ƒ∞smi</label>
	                    <input type="text" class="input-field" id="player-name" placeholder="Turnuvada g√∂r√ºnecek isminiz..." maxlength="20">
	                    <div class="tournament-info">
	                        <small>üí° Turnuva sƒ±rasƒ±nda bu isim diƒüer oyuncular tarafƒ±ndan g√∂r√ºlecektir.</small>
	                    </div>
	                </div>
	            </div>

	            <div class="join-room-section">
	                <label class="setting-label">Mevcut Turnuvaya Katƒ±l</label>
	                <div class="input-group">
	                    <input type="text" class="input-field" id="tournament-code" placeholder="Turnuva kodunu girin..." maxlength="6">
	                    <button class="btn btn-secondary" id="tournament-join-btn">Odaya Katƒ±l</button>
	                </div>
	            </div>

	            <div class="action-buttons">
	                <button class="btn btn-primary" id="tournament-create-btn">Turnuva Odasƒ± Olu≈ütur</button>
	                <button class="btn btn-primary" id="tournament-start-btn" style="display: none;">Turnuvayƒ± Ba≈ülat</button>
	            </div>


			</div>

	        <!-- AI Game Settings -->
	        <div class="settings-panel" id="ai-settings">
	            <h2 class="settings-title">AI ile Oyun Ayarlarƒ±</h2>

	            <div class="settings-grid">
	                <!-- Game Type -->
	                <div class="setting-group">
	                    <label class="setting-label">Oyun Tipi</label>
	                    <div class="radio-group">
	                        <label class="radio-option">
	                            <input type="radio" name="ai-game-type" value="1v1" checked>
	                            <span class="radio-label">1 vs AI</span>
	                        </label>
	                    </div>
	                </div>

	                <!-- AI Difficulty -->
	                <div class="setting-group">
	                    <label class="setting-label">AI Zorluk Seviyesi</label>
	                    <div class="radio-group">
	                        <label class="radio-option difficulty-option">
	                            <input type="radio" name="ai-difficulty" value="easy" checked>
	                            <span class="radio-label">Kolay</span>
	                            <div class="difficulty-tooltip">AI √ßoƒüu zaman kaybeder - Rahat Oyun</div>
	                        </label>
	                        <label class="radio-option difficulty-option">
	                            <input type="radio" name="ai-difficulty" value="medium">
	                            <span class="radio-label">Orta</span>
	                            <div class="difficulty-tooltip">Dengeli m√ºcadele - E≈üit ≈ûans</div>
	                        </label>
	                        <label class="radio-option difficulty-option">
	                            <input type="radio" name="ai-difficulty" value="hard">
	                            <span class="radio-label">Zor</span>
	                            <div class="difficulty-tooltip">AI √ßoƒüunlukla kazanƒ±r - Zorlayƒ±cƒ±</div>
	                        </label>
	                        <label class="radio-option difficulty-option">
	                            <input type="radio" name="ai-difficulty" value="impossible">
	                            <span class="radio-label">ƒ∞mkansƒ±z</span>
	                            <div class="difficulty-tooltip">AI neredeyse hep kazanƒ±r - ƒ∞mkansƒ±z</div>
	                        </label>
	                        <label class="radio-option difficulty-option">
	                            <input type="radio" name="ai-difficulty" value="custom"	                            <span class="radio-label">Frankestein</span>
	                            <div class="difficulty-tooltip">AI yeteneklerini √∂zelle≈ütirebilirsiniz!</div>
	                        </label>
	                    </div>
	                </div>

	                <!-- Custom Game Settings -->
	                <div class="setting-group">
	                    <label class="setting-label">Paddle Y√ºksekliƒüi</label>
	                    <div class="slider-container">
	                        <input type="range" min="50" max="200" value="100" class="slider" id="ai-paddle-height">
	                        <div class="slider-value">
	                            <span>Min: 50px</span>
	                            <span class="current-value" id="ai-paddle-height-value">100px</span>
	                            <span>Max: 200px</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Top Yarƒ± √áapƒ±</label>
	                    <div class="slider-container">
	                        <input type="range" min="5" max="25" value="10" class="slider" id="ai-ball-radius">
	                        <div class="slider-value">
	                            <span>Min: 5px</span>
	                            <span class="current-value" id="ai-ball-radius-value">10px</span>
	                            <span>Max: 25px</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">K√∂≈üe √áarpma Hƒ±zlanmasƒ±</label>
	                    <div class="slider-container">
	                        <input type="range" min="0" max="5" value="1" step="0.1" class="slider" id="ai-corner-boost">
	                        <div class="slider-value">
	                            <span>Yok</span>
	                            <span class="current-value" id="ai-corner-boost-value">1.0x</span>
	                            <span>5x</span>
	                        </div>
	                    </div>
	                </div>

	                <div class="setting-group">
	                    <label class="setting-label">Biti≈ü Skoru</label>
	                    <input type="number" min="1" max="50" value="11" class="input-field" id="ai-winning-score" placeholder="Kazanmak i√ßin gereken skor">
	                </div>
	            </div>

	            <!-- Custom AI Settings -->
	            <div class="ai-special-settings" id="ai-custom-settings">
	                <h3 style="color: #667eea; margin-bottom: 25px; text-align: center; font-size: 1.5rem; font-weight: 700;">ü§ñ √ñzel AI Ayarlarƒ±</h3>

	                <div class="settings-grid">
	                    <div class="setting-group">
	                        <label class="setting-label">Reaksiyon Hƒ±zƒ±</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-reaction-speed">
	                            <div class="slider-value">
	                                <span>√áok Yava≈ü</span>
	                                <span class="current-value" id="ai-reaction-speed-value">5</span>
	                                <span>Anƒ±nda</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Tahmin Doƒüruluƒüu</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-prediction-accuracy">
	                            <div class="slider-value">
	                                <span>K√∂t√º</span>
	                                <span class="current-value" id="ai-prediction-accuracy-value">5</span>
	                                <span>M√ºkemmel</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Genel Doƒüruluk</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-general-accuracy">
	                            <div class="slider-value">
	                                <span>D√º≈ü√ºk</span>
	                                <span class="current-value" id="ai-general-accuracy-value">5</span>
	                                <span>Y√ºksek</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">√ñƒürenme Hƒ±zƒ±</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-learning-speed">
	                            <div class="slider-value">
	                                <span>Yava≈ü</span>
	                                <span class="current-value" id="ai-learning-speed-value">5</span>
	                                <span>Hƒ±zlƒ±</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Hazƒ±rlƒ±k Mesafesi</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-preparation-distance">
	                            <div class="slider-value">
	                                <span>Yakƒ±n</span>
	                                <span class="current-value" id="ai-preparation-distance-value">5</span>
	                                <span>Uzak</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Donma Mesafesi</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-freeze-distance">
	                            <div class="slider-value">
	                                <span>Yakƒ±n</span>
	                                <span class="current-value" id="ai-freeze-distance-value">5</span>
	                                <span>Uzak</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Hedef Kazanma Oranƒ±</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-target-win-rate">
	                            <div class="slider-value">
	                                <span>%10</span>
	                                <span class="current-value" id="ai-target-win-rate-value">%50</span>
	                                <span>%100</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Adalet Seviyesi</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="5" class="slider" id="ai-fairness-level">
	                            <div class="slider-value">
	                                <span>Acƒ±masƒ±z</span>
	                                <span class="current-value" id="ai-fairness-level-value">5</span>
	                                <span>√áok Adil</span>
	                            </div>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Max √úst √úste Kazanma</label>
	                        <div class="slider-container">
	                            <input type="range" min="1" max="10" value="3" class="slider" id="ai-max-consecutive-wins">
	                            <div class="slider-value">
	                                <span>1</span>
	                                <span class="current-value" id="ai-max-consecutive-wins-value">3</span>
	                                <span>10</span>
	                            </div>
	                        </div>
	                    </div>

	                    <!-- AI Special Features -->
	                    <div class="setting-group">
	                        <label class="setting-label">√ñfke Modu</label>
	                        <div class="toggle-container">
	                            <label class="toggle-switch">
	                                <input type="checkbox" id="ai-rage-mode">
	                                <span class="toggle-slider"></span>
	                            </label>
	                            <span style="color: var(--text-secondary); font-size: 0.9rem;">Ard arda kaybedince √∂fkelenir ve daha g√º√ßl√º olur</span>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Yorgunluk Sistemi</label>
	                        <div class="toggle-container">
	                            <label class="toggle-switch">
	                                <input type="checkbox" id="ai-fatigue-system">
	                                <span class="toggle-slider"></span>
	                            </label>
	                            <span style="color: var(--text-secondary); font-size: 0.9rem;">√áok oynayƒ±nca yorulur ve performansƒ± d√º≈üer</span>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Odaklanma Modu</label>
	                        <div class="toggle-container">
	                            <label class="toggle-switch">
	                                <input type="checkbox" id="ai-focus-mode">
	                                <span class="toggle-slider"></span>
	                            </label>
	                            <span style="color: var(--text-secondary); font-size: 0.9rem;">Bazen s√ºper odaklanƒ±r ve m√ºkemmel oynar</span>
	                        </div>
	                    </div>

	                    <div class="setting-group">
	                        <label class="setting-label">Adaptif Zorluk</label>
	                        <div class="toggle-container">
	                            <label class="toggle-switch">
	                                <input type="checkbox" id="ai-adaptive-difficulty">
	                                <span class="toggle-slider"></span>
	                            </label>
	                            <span style="color: var(--text-secondary); font-size: 0.9rem;">Oyuncunun seviyesine g√∂re kendini ayarlar</span>
	                        </div>
	                    </div>
	                </div>
	            </div>

	            <div class="action-buttons">
	                <button class="btn btn-primary" id="ai-start-btn">AI ile Oyuna Ba≈üla</button>
	            </div>
	        </div>
	    </div>
		<div class="game-container" id="gameContainer">
			<canvas id="renderCanvas"></canvas>
		</div>

	</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="module">
// ============================================================================
// IMPORTS
// ============================================================================
import App from './src/App.js';
import WebSocketClient from './src/network/WebSocketClient.js';
import gameConfig from './src/json/GameConfig.js';
import aiConfig from './src/json/AiConfig.js';
import tournamentConfig from './src/json/TournamentConfig.js';

// ============================================================================
// GLOBAL VARIABLES
// ============================================================================
let app = null;
let roomSocket = null;
let currentUserId = null;
let currentUserName = null;
let currentRoomId = null;
let currentGameMode = null;

// ============================================================================
// HELPER FUNCTIONS
// ============================================================================

// Generate random user ID for testing
function generateRandomId() {
    return Math.random().toString(36).substr(2, 9);
}

// Generate random user name for testing
function generateRandomName() {
    const names = ['Ali', 'Ay≈üe', 'Mehmet', 'Fatma', 'Ahmet', 'Zeynep', 'Can', 'Elif', 'Burak', 'Selin',
                   'Ali1', 'Ay≈üe1', 'Mehmet1', 'Fatma1', 'Ahmet1', 'Zeynep1', 'Can1', 'Elif1', 'Burak1', 'Selin1',
                   'Ali2', 'Ay≈üe2', 'Mehmet2', 'Fatma2', 'Ahmet2', 'Zeynep2', 'Can2', 'Elif2', 'Burak2', 'Selin2',
                   'Ali3', 'Ay≈üe3', 'Mehmet3', 'Fatma3', 'Ahmet3', 'Zeynep3', 'Can3', 'Elif3', 'Burak3', 'Selin3'
	];
    return names[Math.floor(Math.random() * names.length)];
}

// Enhanced notification system with stacking
let notificationCount = 0;
const notificationContainer = createNotificationContainer();

function createNotificationContainer() {
    const container = document.createElement('div');
    container.id = 'notification-container';
    container.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        gap: 12px;
        pointer-events: none;
    `;
    document.body.appendChild(container);
    return container;
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    const notificationId = `notification-${notificationCount++}`;
    notification.id = notificationId;
    // Icon se√ßimi
    let icon = '';
    switch(type) {
        case 'success':
            icon = '‚úÖ';
            break;
        case 'error':
            icon = '‚ùå';
            break;
        case 'info':
            icon = '‚ÑπÔ∏è';
            break;
        default:
            icon = 'üì¢';
	}
    notification.style.cssText = `
        padding: 16px 24px;
        background: ${type === 'success' ? 'rgba(0, 255, 0, 0.1)' : type === 'error' ? 'rgba(255, 68, 68, 0.1)' : 'rgba(0, 255, 255, 0.1)'};
        border: 1px solid ${type === 'success' ? 'rgba(0, 255, 0, 0.3)' : type === 'error' ? 'rgba(255, 68, 68, 0.3)' : 'rgba(0, 255, 255, 0.3)'};
        color: white;
        border-radius: 12px;
        font-weight: 500;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        font-family: 'Inter', sans-serif;
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 250px;
        max-width: 400px;
        pointer-events: auto;
        animation: slideInRight 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        transform-origin: right center;
        backdrop-filter: blur(10px);
    `;

    notification.innerHTML = `
        <span style="font-size: 20px;">${icon}</span>
        <span style="flex: 1;">${message}</span>
    `;

    notificationContainer.appendChild(notification);

    // Auto remove after 3 seconds with fade out animation
    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s cubic-bezier(0.6, -0.28, 0.735, 0.045)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 300);
    }, 3000);

    // Click to dismiss
    notification.addEventListener('click', function() {
        this.style.animation = 'slideOutRight 0.3s cubic-bezier(0.6, -0.28, 0.735, 0.045)';
        setTimeout(() => {
            if (this.parentNode) {
                this.remove();
            }
        }, 300);
    });

    // Hover pause
    notification.addEventListener('mouseenter', function() {
        this.style.animationPlayState = 'paused';
    });
    notification.addEventListener('mouseleave', function() {
        this.style.animationPlayState = 'running';
    });
}

// displayMatchPairs fonksiyonunu g√ºncelle
function displayMatchPairs(pairs, participants) {
    const matchPairsSection = document.getElementById('match-pairs-section');
    const matchPairsContainer = document.getElementById('match-pairs-container');

    // Eƒüer next-round-pairs-container varsa onu kullan
    const isNextRound = !matchPairsSection;
    const container = isNextRound ?
        document.getElementById('next-round-pairs-container') :
        matchPairsContainer;

    if (!container) {
        console.error('Match pairs container not found!');
        return;
    }

    if (matchPairsSection && !isNextRound) {
        matchPairsSection.style.display = 'block';
    }

    container.innerHTML = '';

    // Katƒ±lƒ±mcƒ± bilgilerini ID'ye g√∂re hƒ±zlƒ± eri≈üim i√ßin map'le
    const participantsMap = {};
    console.log('Participants for match pairs:', participants);

    if (participants && Array.isArray(participants)) {
        participants.forEach(p => {
            const playerId = p.userId || p.id;
            if (playerId) {
                participantsMap[playerId] = p;
            }
        });
    }

    console.log('Participants map:', participantsMap);
    console.log('Match pairs to display:', pairs);

    // Her e≈üle≈üme i√ßin kart olu≈ütur
    pairs.forEach((pair, index) => {
        const colors = [
            { border: '#00ffff', bg: 'rgba(0, 255, 255, 0.1)' },
            { border: '#ff00ff', bg: 'rgba(255, 0, 255, 0.1)' },
            { border: '#00ff88', bg: 'rgba(0, 255, 136, 0.1)' },
            { border: '#ff8800', bg: 'rgba(255, 136, 0, 0.1)' }
        ];
        const color = colors[index % colors.length];

        const card = document.createElement('div');
        card.className = 'match-pair-card';
        card.style.borderColor = color.border;
        card.style.background = color.bg;

        // Ma√ß ba≈ülƒ±ƒüƒ±
        const header = document.createElement('div');
        header.className = 'match-header';
        const matchNum = pair.matchNumber !== undefined ? pair.matchNumber + 1 : index + 1;
        header.innerHTML = `<div class="match-number">Ma√ß ${matchNum}</div>`;

        // Oyuncular
        const players = document.createElement('div');
        players.className = 'match-players';

        // Player names - √∂nce pair.playerNames'i kontrol et, yoksa participantsMap'ten al
        let player1Name = 'Unknown';
        let player2Name = 'Unknown';

        if (pair.playerNames && pair.playerNames.length >= 2) {
            player1Name = pair.playerNames[0];
            player2Name = pair.playerNames[1];
        } else if (pair.players && pair.players.length >= 2) {
            const p1 = participantsMap[pair.players[0]];
            const p2 = participantsMap[pair.players[1]];
            player1Name = p1 ? (p1.name || p1.userName || 'Unknown') : 'Unknown';
            player2Name = p2 ? (p2.name || p2.userName || 'Unknown') : 'Unknown';
        }

        console.log(`Match ${matchNum}: ${player1Name} vs ${player2Name}`);

        // ƒ∞lk oyuncu - winner/loser durumuna g√∂re stil ekle
        const player1 = document.createElement('div');
        player1.className = 'match-player';
        if (pair.winner === pair.players[0]) {
            player1.classList.add('winner');
            player1.style.borderColor = '#00ff88';
            player1.style.background = 'rgba(0, 255, 136, 0.2)';
        } else if (pair.loser === pair.players[0]) {
            player1.classList.add('loser');
            player1.style.opacity = '0.7';
        }

        player1.innerHTML = `
            <div class="match-player-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24" fill="${color.border}">
                    <path d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM171.7 396.1C166 382 177.4 368 192.6 368L447.5 368C462.7 368 474.1 382 468.4 396.1C444.6 454.7 387.2 496 320.1 496C253 496 195.5 454.7 171.8 396.1zM186.7 207.3C191.2 200.5 200 198.1 207.3 201.8L286.9 241.8C292.3 244.5 295.7 250 295.7 256.1C295.7 262.2 292.3 267.7 286.9 270.4L207.3 310.4C200 314 191.2 311.7 186.7 304.9C182.2 298.1 183.6 289 189.8 283.8L223 256L189.8 228.3C183.6 223.1 182.2 214 186.7 207.2zM450.3 228.4L417 256L450.2 283.7C456.4 288.9 457.8 298 453.3 304.8C448.8 311.6 440 314 432.7 310.3L353.1 270.3C347.7 267.6 344.3 262.1 344.3 256C344.3 249.9 347.7 244.4 353.1 241.7L432.7 201.7C440 198.1 448.8 200.4 453.3 207.2C457.8 214 456.4 223.1 450.2 228.3z"/>
                </svg>
            </div>
            <div class="match-player-name">${player1Name}</div>
            ${pair.winner === pair.players[0] ? '<div class="winner-badge">üèÜ</div>' : ''}
        `;

        // VS yazƒ±sƒ±
        const vs = document.createElement('div');
        vs.className = 'vs-divider';
        vs.innerHTML = `<span class="vs-text">VS</span>`;

        // ƒ∞kinci oyuncu - winner/loser durumuna g√∂re stil ekle
        const player2 = document.createElement('div');
        player2.className = 'match-player';
        if (pair.winner === pair.players[1]) {
            player2.classList.add('winner');
            player2.style.borderColor = '#00ff88';
            player2.style.background = 'rgba(0, 255, 136, 0.2)';
        } else if (pair.loser === pair.players[1]) {
            player2.classList.add('loser');
            player2.style.opacity = '0.7';
        }

        player2.innerHTML = `
            <div class="match-player-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24" fill="${color.border}">
                    <path d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM171.7 396.1C166 382 177.4 368 192.6 368L447.5 368C462.7 368 474.1 382 468.4 396.1C444.6 454.7 387.2 496 320.1 496C253 496 195.5 454.7 171.8 396.1zM186.7 207.3C191.2 200.5 200 198.1 207.3 201.8L286.9 241.8C292.3 244.5 295.7 250 295.7 256.1C295.7 262.2 292.3 267.7 286.9 270.4L207.3 310.4C200 314 191.2 311.7 186.7 304.9C182.2 298.1 183.6 289 189.8 283.8L223 256L189.8 228.3C183.6 223.1 182.2 214 186.7 207.2zM450.3 228.4L417 256L450.2 283.7C456.4 288.9 457.8 298 453.3 304.8C448.8 311.6 440 314 432.7 310.3L353.1 270.3C347.7 267.6 344.3 262.1 344.3 256C344.3 249.9 347.7 244.4 353.1 241.7L432.7 201.7C440 198.1 448.8 200.4 453.3 207.2C457.8 214 456.4 223.1 450.2 228.3z"/>
                </svg>
            </div>
            <div class="match-player-name">${player2Name}</div>
            ${pair.winner === pair.players[1] ? '<div class="winner-badge">üèÜ</div>' : ''}
        `;

        players.appendChild(player1);
        players.appendChild(vs);
        players.appendChild(player2);

        card.appendChild(header);
        card.appendChild(players);
        container.appendChild(card);
    });

    // Katƒ±lƒ±mcƒ±larƒ± e≈üle≈üme renklerine g√∂re g√ºncelle (sadece ilk e≈üle≈ütirmede)
    if (!isNextRound && participants) {
        updateParticipants(participants, 'participants-grid', pairs);
    }
}

// updateParticipants fonksiyonunu g√ºncelle
function updateParticipants(participants, gridId, matchPairs = null) {
    const grid = document.getElementById(gridId);
    if (!grid) return;

    grid.innerHTML = '';

    // E≈üle≈ütirme yapƒ±ldƒ±ysa renk e≈üle≈ütirmelerini olu≈ütur
    const matchColors = {};

    if (matchPairs) {
        matchPairs.forEach((pair, index) => {
            const colors = [
                { border: '#00ffff', bg: 'rgba(0, 255, 255, 0.1)' },
                { border: '#ff00ff', bg: 'rgba(255, 0, 255, 0.1)' },
                { border: '#00ff88', bg: 'rgba(0, 255, 136, 0.1)' },
                { border: '#ff8800', bg: 'rgba(255, 136, 0, 0.1)' }
            ];
            const color = colors[index % colors.length];

            pair.players.forEach(playerId => {
                matchColors[playerId] = color;
            });
        });
    }

    // --- Katƒ±lƒ±mcƒ±larƒ± olu≈ütur ---
    participants.forEach((participant, index) => {
        const card = document.createElement('div');
        card.className = 'participant-card';

        // D√úZELTME: userId yerine id kullan
        const participantId = participant.userId || participant.id;

        // E≈üle≈ütirme yapƒ±ldƒ±ysa o rengi kullan, yoksa sƒ±rayla renk ver
        let color;
        if (matchPairs && matchColors[participantId]) {
            color = matchColors[participantId];
            card.classList.add('matched');
        } else {
            const colors = [
                { border: '#00ffff', bg: 'rgba(0, 255, 255, 0.1)' },
                { border: '#ff00ff', bg: 'rgba(255, 0, 255, 0.1)' },
                { border: '#00ff88', bg: 'rgba(0, 255, 136, 0.1)' },
                { border: '#ff8800', bg: 'rgba(255, 136, 0, 0.1)' }
            ];
            color = colors[index % colors.length];
        }

        card.style.borderColor = color.border;
        card.style.background = color.bg;

        // --- Katƒ±lƒ±mcƒ± ikonu ---
        const icon = document.createElement('div');
        icon.className = 'participant-icon';

        if (participant.isAI) {
            icon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"
                     width="26" height="26" fill="${color.border}">
                    <path d="M352 64C352 46.3 337.7 32 320 32C302.3 32 288 46.3 288 64L288 128L192 128C139 128 96 171 96 224L96 448C96 501 139 544 192 544L448 544C501 544 544 501 544 448L544 224C544 171 501 128 448 128L352 128L352 64zM160 432C160 418.7 170.7 408 184 408L216 408C229.3 408 240 418.7 240 432C240 445.3 229.3 456 216 456L184 456C170.7 456 160 445.3 160 432zM280 432C280 418.7 290.7 408 304 408L336 408C349.3 408 360 418.7 360 432C360 445.3 349.3 456 336 456L304 456C290.7 456 280 445.3 280 432zM400 432C400 418.7 410.7 408 424 408L456 408C469.3 408 480 418.7 480 432C480 445.3 469.3 456 456 456L424 456C410.7 456 400 445.3 400 432zM224 240C250.5 240 272 261.5 272 288C272 314.5 250.5 336 224 336C197.5 336 176 314.5 176 288C176 261.5 197.5 240 224 240zM368 288C368 261.5 389.5 240 416 240C442.5 240 464 261.5 464 288C464 314.5 442.5 336 416 336C389.5 336 368 314.5 368 288zM64 288C64 270.3 49.7 256 32 256C14.3 256 0 270.3 0 288L0 384C0 401.7 14.3 416 32 416C49.7 416 64 401.7 64 384L64 288zM608 256C590.3 256 576 270.3 576 288L576 384C576 401.7 590.3 416 608 416C625.7 416 640 401.7 640 384L640 288C640 270.3 625.7 256 608 256z"/>
                </svg>
            `;
        } else {
            icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="26" height="26" fill="${color.border}"><path d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM171.7 396.1C166 382 177.4 368 192.6 368L447.5 368C462.7 368 474.1 382 468.4 396.1C444.6 454.7 387.2 496 320.1 496C253 496 195.5 454.7 171.8 396.1zM186.7 207.3C191.2 200.5 200 198.1 207.3 201.8L286.9 241.8C292.3 244.5 295.7 250 295.7 256.1C295.7 262.2 292.3 267.7 286.9 270.4L207.3 310.4C200 314 191.2 311.7 186.7 304.9C182.2 298.1 183.6 289 189.8 283.8L223 256L189.8 228.3C183.6 223.1 182.2 214 186.7 207.2zM450.3 228.4L417 256L450.2 283.7C456.4 288.9 457.8 298 453.3 304.8C448.8 311.6 440 314 432.7 310.3L353.1 270.3C347.7 267.6 344.3 262.1 344.3 256C344.3 249.9 347.7 244.4 353.1 241.7L432.7 201.7C440 198.1 448.8 200.4 453.3 207.2C457.8 214 456.4 223.1 450.2 228.3z"/></svg>`;
        }

        // --- Katƒ±lƒ±mcƒ± ismi ---
        const name = document.createElement('div');
        name.className = 'participant-name';
        name.textContent = participant.name || participant.userName || 'Player';

        // --- Host tacƒ± ekle ---
        if (participant.isHost === true) {
            const hostBadge = document.createElement('div');
            hostBadge.className = 'host-badge';
            hostBadge.style.cssText = `
                display: inline-flex;
                margin-left: 8px;
                vertical-align: middle;
            `;
            hostBadge.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" fill="${color.border}">
                    <path d="M345 151.2C354.2 143.9 360 132.6 360 120C360 97.9 342.1 80 320 80C297.9 80 280 97.9 280 120C280 132.6 285.9 143.9 295 151.2L226.6 258.8C216.6 274.5 195.3 278.4 180.4 267.2L120.9 222.7C125.4 216.3 128 208.4 128 200C128 177.9 110.1 160 88 160C65.9 160 48 177.9 48 200C48 221.8 65.5 239.6 87.2 240L119.8 457.5C124.5 488.8 151.4 512 183.1 512L456.9 512C488.6 512 515.5 488.8 520.2 457.5L552.8 240C574.5 239.6 592 221.8 592 200C592 177.9 574.1 160 552 160C529.9 160 512 177.9 512 200C512 208.4 514.6 216.3 519.1 222.7L459.7 267.3C444.8 278.5 423.5 274.6 413.5 258.9L345 151.2z"/>
                </svg>
            `;
            name.appendChild(hostBadge);

            // Add a tooltip for the crown
            const tooltip = document.createElement('span');
            tooltip.className = 'host-tooltip';
            tooltip.textContent = 'Oda Sahibi';
            tooltip.style.cssText = `
                position: absolute;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                top: -25px;
                left: 50%;
                transform: translateX(-50%);
                pointer-events: none;
                z-index: 100;
            `;
            hostBadge.appendChild(tooltip);

            // Show tooltip on hover
            hostBadge.addEventListener('mouseenter', () => {
                tooltip.style.opacity = '1';
                tooltip.style.visibility = 'visible';
            });

            hostBadge.addEventListener('mouseleave', () => {
                tooltip.style.opacity = '0';
                tooltip.style.visibility = 'hidden';
            });

            // Add a subtle glow effect to the host card
            card.style.boxShadow = `0 0 15px ${color.border}`;
        }

        card.appendChild(icon);
        card.appendChild(name);
        grid.appendChild(card);
    });
}

// ============================================================================
// WEBSOCKET HANDLERS
// ============================================================================

// handleWebSocketMessage fonksiyonunu g√ºncelle
function handleWebSocketMessage(message) {
    console.log('üì® Received message:', message);

    switch (message.type) {
        case "created":
            handleRoomCreated(message.payload);
            break;

        case "joined":
            handleRoomJoined(message.payload);
            break;

        case "update":
            handleRoomUpdate(message.payload);
            break;

        case "started":
            handleGameStarted(message.payload);
            break;

        case "finished":
            // T√ºm finished mesajlarƒ± handleGameFinished'e gider
            // O fonksiyon i√ßinde tournament kontrol√º yapƒ±lƒ±r
            handleGameFinished(message.payload);
            break;

        case "matchReady":
            console.log('üé≤ Match pairs ready message received');
            const transformedData = transformMatchmakingData(message.payload);
            handleMatchReady(transformedData);
            break;

        case "error":
            handleError(message.payload);
            break;

        default:
            console.warn('‚ö†Ô∏è Unhandled message type:', message.type);
    }
}

// handleMatchReady fonksiyonunu g√ºncelle
function handleMatchReady(payload) {
    console.log('üé≤ Match pairs ready:', payload);

    if (!payload.matchPairs || !Array.isArray(payload.matchPairs) || payload.matchPairs.length === 0) {
        console.error('Invalid match pairs data:', payload);
        showNotification('E≈üle≈ütirme verisi ge√ßersiz!', 'error');
        return;
    }

    displayMatchPairs(payload.matchPairs, payload.players);

    document.getElementById('tournament-status-display').textContent =
        payload.tournamentStatus || 'E≈üle≈ümeler Hazƒ±r';

    // D√úZELTME: id kullan, userId deƒüil
    const isHost = payload.players && payload.players.some(player => player.id === currentUserId && player.isHost);

    if (isHost) {
        document.getElementById('waiting-players-btn').style.display = 'none';
        document.getElementById('match-players-btn').style.display = 'none';
        document.getElementById('start-tournament-btn').style.display = 'block';
    } else {
        document.getElementById('waiting-players-btn').style.display = 'block';
        document.getElementById('waiting-players-btn').textContent = '‚è≥ Turnuva Ba≈ülatƒ±lƒ±yor...';
        document.getElementById('match-players-btn').style.display = 'none';
        document.getElementById('start-tournament-btn').style.display = 'none';
    }

    showNotification('E≈üle≈ütirmeler tamamlandƒ±!', 'success');
}

// transformMatchmakingData - D√úZELTƒ∞LMƒ∞≈û
function transformMatchmakingData(data) {
    console.log('üîÑ Transforming matchmaking data:', data);

    if (!data) {
        console.error('No data provided');
        return { matchPairs: [], players: [] };
    }

    // Match dizisini al
    let matches = [];

    if (data.match && Array.isArray(data.match)) {
        matches = data.match;
        console.log('‚úÖ Found direct match array:', matches);
    } else if (data.rounds && Array.isArray(data.rounds)) {
        const currentRoundIndex = data.currentRound || 0;
        const currentRound = data.rounds.find(r => r.round === currentRoundIndex) || data.rounds[0];
        matches = currentRound?.matchs || [];
        console.log('‚úÖ Found matches in rounds:', matches);
    }

    if (!matches || matches.length === 0) {
        console.error('No matches found in data');
        return { matchPairs: [], players: [] };
    }

    // T√ºm oyuncularƒ± topla
    const allPlayers = [];
    const playerMap = new Map();

    // Players dizisinden oyuncularƒ± al
    if (data.players && Array.isArray(data.players)) {
        data.players.forEach(player => {
            if (player && player.id && !playerMap.has(player.id)) {
                playerMap.set(player.id, {
                    userId: player.id,
                    name: player.name,
                    isHost: player.isHost || false
                });
                allPlayers.push({
                    userId: player.id,
                    name: player.name,
                    isHost: player.isHost || false
                });
            }
        });
    }

    // Match'lerden de oyuncularƒ± ekle
    matches.forEach(match => {
        if (match.player1 && !playerMap.has(match.player1.id)) {
            playerMap.set(match.player1.id, {
                userId: match.player1.id,
                name: match.player1.name,
                isHost: match.player1.isHost || false
            });
            allPlayers.push({
                userId: match.player1.id,
                name: match.player1.name,
                isHost: match.player1.isHost || false
            });
        }
        if (match.player2 && !playerMap.has(match.player2.id)) {
            playerMap.set(match.player2.id, {
                userId: match.player2.id,
                name: match.player2.name,
                isHost: match.player2.isHost || false
            });
            allPlayers.push({
                userId: match.player2.id,
                name: match.player2.name,
                isHost: match.player2.isHost || false
            });
        }
    });

    console.log('üìã All players collected:', allPlayers);

    // E≈üle≈ütirmeleri d√∂n√º≈üt√ºr
    const matchPairs = matches.map((match, index) => {
        const player1 = match.player1 || { id: 'unknown', name: 'Unknown' };
        const player2 = match.player2 || { id: 'unknown', name: 'Unknown' };

        return {
            matchNumber: match.matchNumber !== undefined ? match.matchNumber : index,
            players: [player1.id, player2.id],
            playerNames: [player1.name, player2.name],
            winner: match.winner || null,
            loser: match.loser || null
        };
    });

    console.log('‚úÖ Match pairs transformed:', matchPairs);

    return {
        matchPairs: matchPairs,
        players: allPlayers,
        tournamentStatus: data.status === 'ready2start' ? 'E≈üle≈ümeler Hazƒ±r' : 'Hazƒ±rlanƒ±yor'
    };
}

function handleRoomCreated(payload) {
    console.log('‚úÖ Room created:', payload);
    currentRoomId = payload.roomId;

    showNotification(`Oda olu≈üturuldu: ${payload.roomId}`, 'success');

    // Show appropriate waiting room
    if (currentGameMode === 'tournament') {
        showTournamentWaitingRoom(payload);
    } else if (currentGameMode === 'ai') {
        showAIWaitingRoom(payload);
    } else {
        showCustomWaitingRoom(payload);
    }
}

function handleRoomJoined(payload) {
    console.log('‚úÖ Joined room:', payload);
    currentRoomId = payload.roomId;

    showNotification(`Odaya katƒ±ldƒ±nƒ±z: ${payload.roomId}`, 'success');

    // Show appropriate waiting room
    if (payload.gameMode === 'tournament') {
        showTournamentWaitingRoom(payload);
    } else {
        showCustomWaitingRoom(payload);
    }
}

// handleRoomUpdate fonksiyonunu g√ºncelle
function handleRoomUpdate(payload) {
    console.log('üîÑ Room update:', payload);

    if (payload.players) {
        const playerCount = payload.players.length;
        const maxPlayers = payload.maxPlayers || 2;

        if (currentGameMode === 'tournament') {
            document.getElementById('players-count').textContent = `${playerCount}/${maxPlayers}`;

            // Status 'ready2start' ise e≈üle≈ütirmeler hazƒ±r
            if (payload.status === 'ready2start' && payload.match) {
                console.log('üé≤ Matches are ready, transforming data...');
                const transformedData = transformMatchmakingData(payload);

                displayMatchPairs(transformedData.matchPairs, transformedData.players);

                document.getElementById('tournament-status-display').textContent =
                    transformedData.tournamentStatus;

                // D√úZELTME: id kullan, userId deƒüil
                const isHost = payload.players.some(player => player.id === currentUserId && player.isHost);

                if (isHost) {
                    document.getElementById('waiting-players-btn').style.display = 'none';
                    document.getElementById('match-players-btn').style.display = 'none';
                    document.getElementById('start-tournament-btn').style.display = 'block';
                } else {
                    document.getElementById('waiting-players-btn').style.display = 'block';
                    document.getElementById('waiting-players-btn').textContent = '‚è≥ Turnuva Ba≈ülatƒ±lƒ±yor...';
                    document.getElementById('match-players-btn').style.display = 'none';
                    document.getElementById('start-tournament-btn').style.display = 'none';
                }

                showNotification('E≈üle≈ütirmeler tamamlandƒ±!', 'success');
            } else {
                // Hen√ºz e≈üle≈ütirme yapƒ±lmamƒ±≈ü
                updateParticipants(payload.players, 'participants-grid');

                // D√úZELTME: id kullan, userId deƒüil
                const isHost = payload.players.some(player => player.id === currentUserId && player.isHost);

                if (isHost) {
                    const minPlayers = 4;

                    if (playerCount >= minPlayers && playerCount % 2 === 0) {
                        document.getElementById('waiting-players-btn').style.display = 'none';
                        document.getElementById('match-players-btn').style.display = 'block';
                        document.getElementById('start-tournament-btn').style.display = 'none';
                        document.getElementById('tournament-status-display').textContent = 'E≈üle≈ütirme Bekleniyor';
                    } else {
                        document.getElementById('waiting-players-btn').style.display = 'block';
                        document.getElementById('waiting-players-btn').textContent =
                            `${minPlayers - playerCount > 0 ? `En az ${minPlayers - playerCount} oyuncu daha gerekli` : '√áift sayƒ±da oyuncu gerekli'}`;
                        document.getElementById('match-players-btn').style.display = 'none';
                        document.getElementById('start-tournament-btn').style.display = 'none';
                        document.getElementById('tournament-status-display').textContent = 'Oyuncular Bekleniyor';
                    }
                } else {
                    document.getElementById('waiting-players-btn').style.display = 'block';
                    document.getElementById('waiting-players-btn').textContent = '‚è≥ E≈üle≈ütirmeler Bekleniyor...';
                    document.getElementById('match-players-btn').style.display = 'none';
                    document.getElementById('start-tournament-btn').style.display = 'none';
                }
            }
        } else if (currentGameMode === 'ai') {
            updateParticipants(payload.players, 'ai-participants-grid');
        } else {
            document.getElementById('custom-players-count').textContent = `${playerCount}/${maxPlayers}`;
            updateParticipants(payload.players, 'custom-participants-grid');

            // D√úZELTME: id kullan, userId deƒüil
            const isHost = payload.players.some(player => player.id === currentUserId && player.isHost);

            if (isHost && playerCount >= maxPlayers) {
                document.getElementById('custom-waiting-players-btn').style.display = 'none';
                document.getElementById('custom-start-game-btn').style.display = 'block';
            }
        }
    }
}

function handleGameStarted(payload) {
    console.log('üéÆ Game started:', payload);
    showNotification('Oyun ba≈ülƒ±yor!', 'success');

    // Hide all waiting rooms
    document.getElementById('waiting-room').classList.remove('active');
    document.getElementById('custom-waiting-room').classList.remove('active');
    document.getElementById('ai-waiting-room').classList.remove('active');
    document.getElementById('game-page').classList.add('hidden');

    // Hide back arrow
    document.getElementById('back-arrow').classList.remove('active');

    // Show game container
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.style.display = 'block';

    app = new App(currentUserId, currentUserName);
    app.start(payload);
}

// function startNextRound(totalRounds, currentRound) {
// 	showNotification('Sonraki round ba≈ülatƒ±lƒ±yor...', 'info');
// 	console.log('Sonraki round ba≈ülatƒ±lƒ±yor...');

//     roomSocket.send("start", {});

// 	if (totalRounds == currentRound) {
// 		console.log('Final round ba≈ülatƒ±lƒ±yor!' );
// 		showNotification('Final round ba≈ülatƒ±lƒ±yor!', 'success');
// 		return;
// 	} else {
// 		showNotification(`Round ${totalRounds} ba≈ülatƒ±ldƒ±!`, 'success');
// 		console.log(`Round ${totalRounds} ba≈ülatƒ±ldƒ±!`);
// 	}
// }

// handleGameFinished fonksiyonunu g√ºncelle
function handleGameFinished(payload) {
    console.log('üèÅ Game finished:', payload);

    // Destroy game
    if (app) {
        app.destroy();
        app = null;
    }

    // Hide game container
    const gameContainer = document.getElementById('gameContainer');
    gameContainer.style.display = 'none';

    // Tournament modunda round biti≈üi kontrol√º
    if (currentGameMode === 'tournament') {
        // Status 'next_round' ise bir sonraki round var demektir
        if (payload.status === 'next_round') {
            console.log('üèÜ Tournament round finished, showing round waiting room');
            handleRoundFinished(payload);
            return;
        }

        // Status 'finished' ise turnuva bitti demektir
        if (payload.status === 'finished' || payload.isFinal) {
            console.log('üèÜ Tournament completed!');
            showNotification('üèÜ Turnuva tamamlandƒ±!', 'success');

            // Kazananƒ± g√∂ster
            if (payload.winner) {
                showNotification(`üéâ Kazanan: ${payload.winner.name}`, 'success');
            } else if (payload.players && payload.players.length === 1) {
                showNotification(`üéâ Kazanan: ${payload.players[0].name}`, 'success');
            }

            // Lobiye d√∂n
            // setTimeout(() => {
            //     returnToLobby();
            // }, 3000);
            return;
        }
    }

    // Normal oyun biti≈üi
    showNotification('Oyun bitti!', 'info');

    // Reset room state
    currentRoomId = null;
    currentGameMode = null;

    // Show game page
    document.getElementById('game-page').classList.remove('hidden');
}
function handleError(payload) {
    console.error('‚ùå Error:', payload);
    const errorMessage = payload.message || payload.error || 'Bir hata olu≈ütu';
    showNotification(errorMessage, 'error');
}

// ============================================================================
// UI FUNCTIONS
// ============================================================================

// showTournamentWaitingRoom fonksiyonunu g√ºncelle
function showTournamentWaitingRoom(data) {
    console.log('üè† Showing tournament waiting room:', data);

    document.getElementById('game-page').classList.add('hidden');
    document.getElementById('waiting-room').classList.add('active');
    document.getElementById('back-arrow').classList.add('active');

    document.getElementById('room-code-display').textContent = data.roomId || 'TOUR-XXXXX';
    document.getElementById('players-count').textContent = `${data.players?.length || 0}/${data.maxPlayers || 8}`;

    // Turnuva durumunu g√ºncelle
    const statusText = data.status === 'ready2start' ? 'E≈üle≈ümeler Hazƒ±r' : 'Oyuncular Bekleniyor';
    document.getElementById('tournament-status-display').textContent = statusText;

    if (data.players) {
        // D√úZELTME: id kullan, userId deƒüil
        const isHost = data.players.some(player => player.id === currentUserId && player.isHost);

        // Eƒüer status 'ready2start' ise ve match varsa e≈üle≈ütirmeleri g√∂ster
        if (data.status === 'ready2start' && data.match) {
            console.log('üé≤ Showing match pairs...');
            const transformedData = transformMatchmakingData(data);
            displayMatchPairs(transformedData.matchPairs, transformedData.players);

            // Host i√ßin turnuvayƒ± ba≈ülat butonunu g√∂ster
            if (isHost) {
                document.getElementById('waiting-players-btn').style.display = 'none';
                document.getElementById('match-players-btn').style.display = 'none';
                document.getElementById('start-tournament-btn').style.display = 'block';
            } else {
                document.getElementById('waiting-players-btn').style.display = 'block';
                document.getElementById('waiting-players-btn').textContent = '‚è≥ Turnuva Ba≈ülatƒ±lƒ±yor...';
                document.getElementById('match-players-btn').style.display = 'none';
                document.getElementById('start-tournament-btn').style.display = 'none';
            }
        } else {
            // Hen√ºz e≈üle≈ütirme yapƒ±lmamƒ±≈ü
            updateParticipants(data.players, 'participants-grid');

            if (isHost) {
                const playerCount = data.players.length;
                const minPlayers = 4;

                if (playerCount >= minPlayers && playerCount % 2 === 0) {
                    document.getElementById('waiting-players-btn').style.display = 'none';
                    document.getElementById('match-players-btn').style.display = 'block';
                    document.getElementById('start-tournament-btn').style.display = 'none';
                } else {
                    document.getElementById('waiting-players-btn').style.display = 'block';
                    document.getElementById('waiting-players-btn').textContent =
                        `${minPlayers - playerCount > 0 ? `En az ${minPlayers - playerCount} oyuncu daha gerekli` : '√áift sayƒ±da oyuncu gerekli'}`;
                    document.getElementById('match-players-btn').style.display = 'none';
                    document.getElementById('start-tournament-btn').style.display = 'none';
                }
            } else {
                document.getElementById('waiting-players-btn').style.display = 'block';
                document.getElementById('waiting-players-btn').textContent = '‚è≥ E≈üle≈ütirmeler Bekleniyor...';
                document.getElementById('match-players-btn').style.display = 'none';
                document.getElementById('start-tournament-btn').style.display = 'none';
            }
        }
    }
}

// showCustomWaitingRoom fonksiyonunu g√ºncelle
function showCustomWaitingRoom(data) {
    document.getElementById('game-page').classList.add('hidden');
    document.getElementById('custom-waiting-room').classList.add('active');
    document.getElementById('back-arrow').classList.add('active');

    document.getElementById('custom-room-code-display').textContent = data.roomId;

    const gameTypeMap = {
        'classic': '1 vs 1',
        'multiplayer': '2 vs 2',
        'local': 'local'
    };
    document.getElementById('custom-game-type-display').textContent = gameTypeMap[data.gameMode] || '1 vs 1';

    const playerCount = data.players?.length || 1;
    const maxPlayers = data.maxPlayers || 2;
    document.getElementById('custom-players-count').textContent = `${playerCount}/${maxPlayers}`;

    // Update game settings display
    if (data.gameSettings) {
        document.getElementById('custom-paddle-display').textContent = `${data.gameSettings.paddleHeight}px`;
        document.getElementById('custom-ball-display').textContent = `${data.gameSettings.ballRadius}px`;

        const cornerBoost = data.gameSettings.cornerBoost || data.gameSettings.ballSpeedIncrease || 1.0;
        document.getElementById('custom-corner-display').textContent = `${parseFloat(cornerBoost).toFixed(1)}x`;

        document.getElementById('custom-score-display').textContent = data.gameSettings.maxScore;
    }

    if (data.players) {
        updateParticipants(data.players, 'custom-participants-grid');
    }

    // D√úZELTME: id kullan, userId deƒüil
    const isHost = data.players && data.players.some(player => player.id === currentUserId && player.isHost);

    // Show/hide buttons
    if (isHost) {
        if (playerCount >= maxPlayers) {
            document.getElementById('custom-waiting-players-btn').style.display = 'none';
            document.getElementById('custom-start-game-btn').style.display = 'block';
        } else {
            document.getElementById('custom-waiting-players-btn').style.display = 'block';
            document.getElementById('custom-start-game-btn').style.display = 'none';
        }
    } else {
        document.getElementById('custom-waiting-players-btn').style.display = 'block';
        document.getElementById('custom-waiting-players-btn').textContent = '‚è≥ Oda Sahibi Bekleniyor...';
        document.getElementById('custom-start-game-btn').style.display = 'none';
    }
}

function showAIWaitingRoom(data) {
    document.getElementById('game-page').classList.add('hidden');
    document.getElementById('ai-waiting-room').classList.add('active');
    document.getElementById('back-arrow').classList.add('active');

    // Update AI difficulty display
    const difficultyMap = {
        'easy': 'Kolay',
        'medium': 'Orta',
        'hard': 'Zor',
        'impossible': 'ƒ∞mkansƒ±z',
        'custom': '√ñzel'
    };

    const difficulty = data.aiSettings?.difficulty || 'medium';
    document.getElementById('ai-difficulty-display').textContent = difficultyMap[difficulty];
    document.getElementById('ai-type-display').textContent = difficulty === 'custom' ? '√ñzelle≈ütirilmi≈ü' : 'Standart';

    // Update game settings display
    if (data.gameSettings) {
        document.getElementById('ai-paddle-display').textContent = `${data.gameSettings.paddleHeight}px`;
        document.getElementById('ai-ball-display').textContent = `${data.gameSettings.ballRadius}px`;

        // D√úZELTME: cornerBoost veya ballSpeedIncrease deƒüerini kontrol et
        const cornerBoost = data.gameSettings.cornerBoost || data.gameSettings.ballSpeedIncrease || 1.0;
        document.getElementById('ai-corner-display').textContent = `${parseFloat(cornerBoost).toFixed(1)}x`;

        document.getElementById('ai-score-display').textContent = data.gameSettings.maxScore;
    }

    // Show custom AI settings if custom difficulty
    if (difficulty === 'custom' && data.aiSettings) {
        const customSettingsDiv = document.getElementById('ai-custom-settings-display');
        customSettingsDiv.style.display = 'block';

        document.getElementById('ai-reaction-display').textContent = data.aiSettings.reactionSpeed || 5;
        document.getElementById('ai-prediction-display').textContent = data.aiSettings.predictionAccuracy || 5;
        document.getElementById('ai-accuracy-display').textContent = data.aiSettings.generalAccuracy || 5;
        document.getElementById('ai-learning-display').textContent = data.aiSettings.learningSpeed || 5;
    }

    // Update participants
    const players = [
        { name: currentUserName, isAI: false },
        { name: 'AI Opponent', isAI: true }
    ];
    updateParticipants(players, 'ai-participants-grid');
}

// ============================================================================
// EVENT HANDLERS
// ============================================================================

// Game Mode Selection
document.getElementById('custom-mode').addEventListener('click', function() {
    document.querySelectorAll('.game-mode-card').forEach(card => card.classList.remove('active'));
    this.classList.add('active');

    document.querySelectorAll('.settings-panel').forEach(panel => panel.classList.remove('active'));
    document.getElementById('custom-settings').classList.add('active');

    currentGameMode = 'custom';
});

document.getElementById('tournament-mode').addEventListener('click', function() {
    document.querySelectorAll('.game-mode-card').forEach(card => card.classList.remove('active'));
    this.classList.add('active');

    document.querySelectorAll('.settings-panel').forEach(panel => panel.classList.remove('active'));
    document.getElementById('tournament-settings').classList.add('active');

    currentGameMode = 'tournament';
});

document.getElementById('ai-mode').addEventListener('click', function() {
    document.querySelectorAll('.game-mode-card').forEach(card => card.classList.remove('active'));
    this.classList.add('active');

    document.querySelectorAll('.settings-panel').forEach(panel => panel.classList.remove('active'));
    document.getElementById('ai-settings').classList.add('active');

    currentGameMode = 'ai';
});

// Custom Game - Create Room
document.getElementById('custom-create-btn').addEventListener('click', function() {
    const gameType = document.querySelector('input[name="custom-game-type"]:checked').value;

    let gameMode;
    if (gameType === '1v1') gameMode = 'classic';
    else if (gameType === '2v2') gameMode = 'multiplayer';
    else if (gameType === 'co-op') gameMode = 'local';

    const data = {
        name: `${currentUserName}'s Room`,
        gameMode: gameMode,
        gameSettings: {
			//!!
			...gameConfig.gameSettings,
            paddleHeight: parseInt(document.getElementById('paddle-height').value),
            ballRadius: parseInt(document.getElementById('ball-radius').value),
			// DEƒûƒ∞≈ûECEK
            ballSpeedIncrease: parseFloat(document.getElementById('corner-boost').value),
            maxScore: parseInt(document.getElementById('winning-score').value)
        }
    };

    currentGameMode = 'custom';
    roomSocket.send("create", data);
    showNotification('Oda olu≈üturuluyor...', 'info');
});

// Custom Game - Join Room
document.getElementById('custom-join-btn').addEventListener('click', function() {
    const roomCode = document.getElementById('custom-room-code').value.trim().toUpperCase();

    if (!roomCode) {
        showNotification('L√ºtfen oda kodunu girin!', 'error');
        return;
    }

    if (roomCode.length !== 6) {
        showNotification('Oda kodu 6 karakter olmalƒ±dƒ±r!', 'error');
        return;
    }

    currentGameMode = 'custom';
    roomSocket.send("join", { roomId: roomCode , gameMode: 'play-page'});
    showNotification(`${roomCode} kodlu odaya katƒ±lƒ±yorsunuz...`, 'info');
});

// Custom Game - Start Game
document.getElementById('custom-start-game-btn').addEventListener('click', function() {
    roomSocket.send("start", {});
    showNotification('Oyun ba≈ülatƒ±lƒ±yor...', 'info');
});

document.getElementById('ai-start-game-btn').addEventListener('click', function() {
    roomSocket.send("start", {});
    showNotification('Oyun ba≈ülatƒ±lƒ±yor...', 'info');
});

// AI Game - Start
document.getElementById('ai-start-btn').addEventListener('click', function() {
    const difficulty = document.querySelector('input[name="ai-difficulty"]:checked').value;

    const data = {
        name: `${currentUserName}'s AI Room`,
        gameMode: "ai",
        gameSettings: {
			...gameConfig.gameSettings,
            paddleHeight: parseInt(document.getElementById('ai-paddle-height').value),
            ballRadius: parseInt(document.getElementById('ai-ball-radius').value),
            ballSpeedIncrease: parseFloat(document.getElementById('ai-corner-boost').value),
            maxScore: parseInt(document.getElementById('ai-winning-score').value)
        },
        aiSettings: {
            difficulty: difficulty
        }
    };

    // Custom AI settings
    if (difficulty === 'custom') {
        data.aiSettings = {
            ...data.aiSettings,
            reactionSpeed: parseInt(document.getElementById('ai-reaction-speed').value),
            predictionAccuracy: parseInt(document.getElementById('ai-prediction-accuracy').value),
            generalAccuracy: parseInt(document.getElementById('ai-general-accuracy').value),
            learningSpeed: parseInt(document.getElementById('ai-learning-speed').value),
            preparationDistance: parseInt(document.getElementById('ai-preparation-distance').value),
            freezeDistance: parseInt(document.getElementById('ai-freeze-distance').value),
            targetWinRate: parseInt(document.getElementById('ai-target-win-rate').value),
            fairnessLevel: parseInt(document.getElementById('ai-fairness-level').value),
            maxConsecutiveWins: parseInt(document.getElementById('ai-max-consecutive-wins').value),
            rageMode: document.getElementById('ai-rage-mode').checked,
            fatigueSystem: document.getElementById('ai-fatigue-system').checked,
            focusMode: document.getElementById('ai-focus-mode').checked,
            adaptiveDifficulty: document.getElementById('ai-adaptive-difficulty').checked
        };
    }

    currentGameMode = 'ai';
    roomSocket.send("create", data);
    showNotification('AI oyunu olu≈üturuluyor...', 'info');
});

// Tournament - Create
document.getElementById('tournament-create-btn').addEventListener('click', function() {
    const tournamentName = document.getElementById('tournament-name').value.trim();
    const tournamentSize = document.querySelector('input[name="tournament-size"]:checked').value;

    if (!tournamentName) {
        showNotification('L√ºtfen turnuva ismini girin!', 'error');
        return;
    }

    let maxPlayers = parseInt(tournamentSize);
    if (tournamentSize === 'custom') {
        maxPlayers = parseInt(document.getElementById('custom-tournament-size').value);
        if (isNaN(maxPlayers) || maxPlayers < 4) {
            showNotification('L√ºtfen 4 veya daha b√ºy√ºk bir sayƒ± girin!', 'error');
            return;
        }
        // Check if power of 2
        if ((maxPlayers & (maxPlayers - 1)) !== 0) {
            showNotification('Ki≈üi sayƒ±sƒ± 2\'nin kuvveti olmalƒ±dƒ±r! (4, 8, 16, 32...)', 'error');
            return;
        }
    }

    const data = {
        name: tournamentName,
        gameMode: "tournament",
		...gameConfig,
        tournamentSettings: {
            maxPlayers: maxPlayers
        }
    };

    currentGameMode = 'tournament';
    roomSocket.send("create", data);
    showNotification('Turnuva olu≈üturuluyor...', 'info');
});

// Tournament - Join
document.getElementById('tournament-join-btn').addEventListener('click', function() {
    const tournamentCode = document.getElementById('tournament-code').value.trim().toUpperCase();

    if (!tournamentCode) {
        showNotification('L√ºtfen turnuva kodunu girin!', 'error');
        return;
	}

    currentGameMode = 'tournament';
    roomSocket.send("join", {roomId: tournamentCode, gameMode: 'tournament-page'});
    showNotification(`${tournamentCode} kodlu turnuvaya katƒ±lƒ±yorsunuz...`, 'info');
});

// Tournament - Start
document.getElementById('start-tournament-btn').addEventListener('click', function() {
    // Butonu devre dƒ±≈üƒ± bƒ±rak ve y√ºkleniyor g√∂ster
    this.disabled = true;
    this.innerHTML = '<div class="loading"></div> Turnuva Ba≈ülatƒ±lƒ±yor...';

    // Turnuva ba≈ülatma isteƒüi g√∂nder
    roomSocket.send("start", { roomId: currentRoomId });
    showNotification('Turnuva ba≈ülatƒ±lƒ±yor...', 'info');

    // Eƒüer sunucudan yanƒ±t gelmezse butonu 10 saniye sonra tekrar etkinle≈ütir
    setTimeout(() => {
        if (this.disabled) {
            this.disabled = false;
            this.innerHTML = 'üöÄ Turnuvayƒ± Ba≈ülat';
        }
    }, 10000);
});

// Final Round butonuna event listener ekle
document.getElementById('final-round-btn').addEventListener('click', function() {
    this.disabled = true;
    this.innerHTML = '<div class="loading"></div> Starting Final Round...';

    roomSocket.send("start", {
        roomId: currentRoomId
    });

    showNotification('üèÜ Final round ba≈ülatƒ±lƒ±yor!', 'success');

    setTimeout(() => {
        if (this.disabled) {
            this.disabled = false;
            this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="20" height="20" fill="white" style="margin-right: 8px;"><path d="M400 0L176 0c-26.5 0-48.1 21.8-47.1 48.2c.2 5.3 .4 10.6 .7 15.8L24 64C10.7 64 0 74.7 0 88c0 92.6 33.5 157 78.5 200.7c44.3 43.1 98.3 64.8 138.1 75.8c23.4 6.5 39.4 26 39.4 45.6c0 20.9-17 37.9-37.9 37.9L192 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-26.1 0C337 448 320 431 320 410.1c0-19.6 15.9-39.2 39.4-45.6c39.9-11 93.9-32.7 138.2-75.8C542.5 245 576 180.6 576 88c0-13.3-10.7-24-24-24L446.4 64c.3-5.2 .5-10.4 .7-15.8C448.1 21.8 426.5 0 400 0zM48.9 112l84.4 0c9.1 90.1 29.2 150.3 51.9 190.6c-24.9-11-50.8-26.5-73.2-48.3c-32-31.1-58-76-63-142.3zM464.1 254.3c-22.4 21.8-48.3 37.3-73.2 48.3c22.7-40.3 42.8-100.5 51.9-190.6l84.4 0c-5.1 66.3-31.1 111.2-63 142.3z"/></svg><span>Start Final Round</span>';
        }
    }, 10000);
});

// Ki≈üileri e≈üle≈ütir butonu
document.getElementById('match-players-btn').addEventListener('click', function() {
    if (!currentRoomId) return;

    // E≈üle≈ütirmeleri sunucuya g√∂nder
    roomSocket.send("matchTournament", { roomId: currentRoomId });
    showNotification('E≈üle≈ütirmeler yapƒ±lƒ±yor...', 'info');
});

// Back Arrow
document.getElementById('back-arrow').addEventListener('click', function() {
    // Leave room if in one
    if (currentRoomId) {
        roomSocket.send("leave", { roomId: currentRoomId });
        currentRoomId = null;
    }

    // Hide all waiting rooms
    document.querySelectorAll('.waiting-room').forEach(room => room.classList.remove('active'));

    // Show game page
    document.getElementById('game-page').classList.remove('hidden');

    // Hide back arrow
    this.classList.remove('active');

    showNotification('Odadan ayrƒ±ldƒ±nƒ±z', 'info');
});

// Tournament Size - Custom Option
document.querySelectorAll('input[name="tournament-size"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const customInput = document.getElementById('custom-tournament-size');
        if (this.value === 'custom') {
            customInput.style.display = 'block';
        } else {
            customInput.style.display = 'none';
        }
    });
});

// AI Difficulty - Custom Option
document.querySelectorAll('input[name="ai-difficulty"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const customSettings = document.getElementById('ai-custom-settings');
        if (this.value === 'custom') {
            customSettings.classList.add('active');
        } else {
            customSettings.classList.remove('active');
        }
    });
});

// ============================================================================
// SLIDER VALUE UPDATES
// ============================================================================

// Custom Game Sliders
document.getElementById('paddle-height').addEventListener('input', function() {
    document.getElementById('paddle-height-value').textContent = this.value + 'px';
});

document.getElementById('ball-radius').addEventListener('input', function() {
    document.getElementById('ball-radius-value').textContent = this.value + 'px';
});

document.getElementById('corner-boost').addEventListener('input', function() {
    document.getElementById('corner-boost-value').textContent = parseFloat(this.value).toFixed(1) + 'x';
});

// AI Game Sliders
document.getElementById('ai-paddle-height').addEventListener('input', function() {
    document.getElementById('ai-paddle-height-value').textContent = this.value + 'px';
});

document.getElementById('ai-ball-radius').addEventListener('input', function() {
    document.getElementById('ai-ball-radius-value').textContent = this.value + 'px';
});

document.getElementById('ai-corner-boost').addEventListener('input', function() {
    document.getElementById('ai-corner-boost-value').textContent = parseFloat(this.value).toFixed(1) + 'x';
});

// AI Custom Settings Sliders
document.getElementById('ai-reaction-speed').addEventListener('input', function() {
    document.getElementById('ai-reaction-speed-value').textContent = this.value;
});

document.getElementById('ai-prediction-accuracy').addEventListener('input', function() {
    document.getElementById('ai-prediction-accuracy-value').textContent = this.value;
});

document.getElementById('ai-general-accuracy').addEventListener('input', function() {
    document.getElementById('ai-general-accuracy-value').textContent = this.value;
});

document.getElementById('ai-learning-speed').addEventListener('input', function() {
    document.getElementById('ai-learning-speed-value').textContent = this.value;
});

document.getElementById('ai-preparation-distance').addEventListener('input', function() {
    document.getElementById('ai-preparation-distance-value').textContent = this.value;
});

document.getElementById('ai-freeze-distance').addEventListener('input', function() {
    document.getElementById('ai-freeze-distance-value').textContent = this.value;
});

document.getElementById('ai-target-win-rate').addEventListener('input', function() {
    document.getElementById('ai-target-win-rate-value').textContent = '%' + (this.value * 10);
});

document.getElementById('ai-fairness-level').addEventListener('input', function() {
    document.getElementById('ai-fairness-level-value').textContent = this.value;
});

document.getElementById('ai-max-consecutive-wins').addEventListener('input', function() {
    document.getElementById('ai-max-consecutive-wins-value').textContent = this.value;
});

// ============================================================================
// INITIALIZATION
// ============================================================================

// Generate user credentials
currentUserId = generateRandomId();
currentUserName = generateRandomName();
console.log(`üéÆ User initialized - ID: ${currentUserId}, Name: ${currentUserName}`);

// Initialize WebSocket
roomSocket = new WebSocketClient(window.location.hostname, 3004);

// WebSocket event handlers
roomSocket.onConnect(() => {
    console.log('‚úÖ Connected to room server');
    showNotification('Sunucuya baƒülandƒ±', 'success');
});

roomSocket.onMessage((message) => {
    try {
        console.log(`üì• Received WebSocket message:`, message);

        // Eƒüer matchReady mesajƒ± gelirse √∂zel i≈üleme yap
        if (message.type === "matchReady") {
            const transformedData = transformMatchmakingData(message.payload);
            handleMatchReady(transformedData);
            return;
        }

        // Diƒüer mesajlar i√ßin normal i≈üleme devam et
        handleWebSocketMessage(message);
    } catch (error) {
        console.error('Error processing WebSocket message:', error);
        showNotification('Mesaj i≈ülenirken hata olu≈ütu', 'error');
    }
});


roomSocket.onClose((error) => {
    console.log(`‚ùå Disconnected from room server: ${error.code} - ${error.reason}`);
    showNotification('Sunucu baƒülantƒ±sƒ± kesildi', 'error');
});

roomSocket.onError((error) => {
    console.error('‚ùå Room server connection error:', error);
    showNotification('Baƒülantƒ± hatasƒ±', 'error');
});

// Connect to server
roomSocket.connect("ws/client", {
    userID: currentUserId,
    userName: currentUserName
});

// Export for debugging
window.roomSocket = roomSocket;
window.app = app;

console.log('üéÆ Application initialized successfully!');
showNotification('Ho≈ü geldiniz! ' + currentUserName, 'success');

// Fast Game Event Handler - YENƒ∞
document.getElementById('fast-game-mode').addEventListener('click', function() {
    showNotification('Hƒ±zlƒ± oyun ba≈ülatƒ±lƒ±yor...', 'success');

    // Show loading screen
    const loadingScreen = document.getElementById('loading-screen');
    const gamePage = document.getElementById('game-page');

    gamePage.classList.add('hidden');
    loadingScreen.classList.add('active');

    roomSocket.send("quickMatch");
});

// Loading Back Arrow
document.getElementById('loading-back-arrow').addEventListener('click', function() {
    const loadingScreen = document.getElementById('loading-screen');
    const gamePage = document.getElementById('game-page');

    loadingScreen.classList.remove('active');
    gamePage.classList.remove('hidden');

    showNotification('Hƒ±zlƒ± oyun iptal edildi', 'info');
});

// DOM Elements
const gameModeCards = document.querySelectorAll('.game-mode-card');
const settingsPanels = document.querySelectorAll('.settings-panel');
const aiDifficultyRadios = document.querySelectorAll('input[name="ai-difficulty"]');
const aiCustomSettings = document.getElementById('ai-custom-settings');

// Initialize all sliders
function updateSliderValue(sliderId, valueId, suffix = '') {
    const slider = document.getElementById(sliderId);
    const valueDisplay = document.getElementById(valueId);

    if (!slider || !valueDisplay) return;

    slider.addEventListener('input', function() {
        let value = this.value;
        if (sliderId.includes('corner-boost')) {
            value = parseFloat(value).toFixed(1) + 'x';
        } else if (sliderId.includes('target-win-rate')) {
            value = (parseInt(value) * 10) + '%';
        } else {
            value += suffix;
        }

        // Animate value change
        valueDisplay.style.transform = 'scale(1.1)';
        valueDisplay.textContent = value;

        setTimeout(() => {
            valueDisplay.style.transform = 'scale(1)';
        }, 200);
    });
}

// Initialize all sliders (paddle-speed ve ball-speed √ßƒ±karƒ±ldƒ±)
const sliders = [
    ['paddle-height', 'paddle-height-value', 'px'],
    ['ball-radius', 'ball-radius-value', 'px'],
    ['corner-boost', 'corner-boost-value'],
    ['ai-paddle-height', 'ai-paddle-height-value', 'px'],
    ['ai-ball-radius', 'ai-ball-radius-value', 'px'],
    ['ai-corner-boost', 'ai-corner-boost-value'],
    ['ai-reaction-speed', 'ai-reaction-speed-value'],
    ['ai-prediction-accuracy', 'ai-prediction-accuracy-value'],
    ['ai-general-accuracy', 'ai-general-accuracy-value'],
    ['ai-learning-speed', 'ai-learning-speed-value'],
    ['ai-preparation-distance', 'ai-preparation-distance-value'],
    ['ai-freeze-distance', 'ai-freeze-distance-value'],
    ['ai-target-win-rate', 'ai-target-win-rate-value'],
    ['ai-fairness-level', 'ai-fairness-level-value'],
    ['ai-max-consecutive-wins', 'ai-max-consecutive-wins-value']
];

sliders.forEach(([sliderId, valueId, suffix]) => {
    updateSliderValue(sliderId, valueId, suffix || '');
});

// Smooth transitions for all interactive elements
document.querySelectorAll('.btn, .input-field, .radio-option').forEach(element => {
    element.style.transition = 'all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
});

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // ESC to close active panels
    if (e.key === 'Escape') {
        gameModeCards.forEach(c => c.classList.remove('active'));
        settingsPanels.forEach(p => p.classList.remove('active'));
    }
});

// Initialize tooltips
const tooltips = document.querySelectorAll('.difficulty-tooltip');
tooltips.forEach(tooltip => {
    tooltip.style.transition = 'all 0.3s ease';
});

// Add focus trap for accessibility
settingsPanels.forEach(panel => {
    panel.addEventListener('keydown', function(e) {
        if (e.key === 'Tab') {
            const focusableElements = this.querySelectorAll(
                'button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];
            if (e.shiftKey && document.activeElement === firstElement) {
                e.preventDefault();
                lastElement.focus();
            } else if (!e.shiftKey && document.activeElement === lastElement) {
                e.preventDefault();
                firstElement.focus();
            }
        }
    });
});

// Sayfa y√ºklendikten sonra Custom Game sekmesini a√ß
const customModeCard = document.getElementById('custom-mode');
const customSettings = document.getElementById('custom-settings');

if (customModeCard && customSettings && !customModeCard.classList.contains('active')) {
    // √ñnce t√ºm sekmeleri kapat
    document.querySelectorAll('.mode-card').forEach(card => {
        card.classList.remove('active');
    });
    document.querySelectorAll('.game-settings').forEach(settings => {
        settings.classList.remove('active');
    });

    // Custom Game sekmesini a√ß
    customModeCard.classList.add('active');
    customSettings.classList.add('active');
}


// Global deƒüi≈ükenler b√∂l√ºm√ºne ekle
let tournamentData = {
    currentRound: 0,
    totalRounds: 0,
    winners: [],
    nextMatches: []
};

// showRoundWaitingRoom fonksiyonunu g√ºncelle
function showRoundWaitingRoom(data) {
    console.log('üìã Showing round waiting room with data:', data);

    // T√ºm odalarƒ± gizle
    document.querySelectorAll('.waiting-room').forEach(room => room.classList.remove('active'));
    document.getElementById('game-page').classList.add('hidden');

    // Round waiting room'u g√∂ster
    const roundWaitingRoom = document.getElementById('round-waiting-room');
    if (!roundWaitingRoom) {
        console.error('Round waiting room element not found!');
        return;
    }

    roundWaitingRoom.classList.add('active');

    // Back arrow'u g√∂ster
    const backArrow = document.getElementById('back-arrow');
    if (backArrow) {
        backArrow.classList.add('active');
    }

    // Round bilgilerini g√ºncelle
    const currentRoundDisplay = document.getElementById('round-current-display');
    const totalRoundsDisplay = document.getElementById('round-total-display');
    const remainingPlayersDisplay = document.getElementById('round-remaining-players');
    const nextRoundDisplay = document.getElementById('round-next-display');

    const currentRound = data.currentRound || 1;
    const totalRounds = data.totalRounds || data.maxRound || 3;
    const winnersCount = data.winners ? data.winners.length : 0;

    if (currentRoundDisplay) currentRoundDisplay.textContent = currentRound;
    if (totalRoundsDisplay) totalRoundsDisplay.textContent = totalRounds;
    if (remainingPlayersDisplay) remainingPlayersDisplay.textContent = winnersCount;

    // Next round bilgisi - D√úZELTƒ∞LDƒ∞
    const nextRound = currentRound + 1;
    if (nextRoundDisplay) {
        if (nextRound > totalRounds) {
            nextRoundDisplay.textContent = 'Completed';
        } else if (nextRound === totalRounds) {
            nextRoundDisplay.textContent = 'Final';
        } else {
            nextRoundDisplay.textContent = `Round ${nextRound}`;
        }
    }

    console.log(`Round Info - Current: ${currentRound}, Total: ${totalRounds}, Next: ${nextRound}`);

    // Kazananlarƒ± g√∂ster
    console.log('Displaying winners:', data.winners);
    if (data.winners && data.winners.length > 0) {
        updateParticipants(data.winners, 'round-winners-grid');
    }

    // Bir sonraki round e≈üle≈ütirmelerini g√∂ster
    const nextRoundPairsSection = document.getElementById('next-round-pairs-section');
    if (data.nextMatches && data.nextMatches.length > 0) {
        console.log('Displaying next matches:', data.nextMatches);
        if (nextRoundPairsSection) {
            nextRoundPairsSection.style.display = 'block';
        }

        const nextRoundContainer = document.getElementById('next-round-pairs-container');
        if (nextRoundContainer) {
            nextRoundContainer.innerHTML = '';

            data.nextMatches.forEach((pair, index) => {
                const colors = [
                    { border: '#00ffff', bg: 'rgba(0, 255, 255, 0.1)' },
                    { border: '#ff00ff', bg: 'rgba(255, 0, 255, 0.1)' },
                    { border: '#00ff88', bg: 'rgba(0, 255, 136, 0.1)' },
                    { border: '#ff8800', bg: 'rgba(255, 136, 0, 0.1)' }
                ];
                const color = colors[index % colors.length];

                const card = document.createElement('div');
                card.className = 'match-pair-card';
                card.style.borderColor = color.border;
                card.style.background = color.bg;

                const header = document.createElement('div');
                header.className = 'match-header';
                const matchNum = pair.matchNumber !== undefined ? pair.matchNumber + 1 : index + 1;
                header.innerHTML = `<div class="match-number">Ma√ß ${matchNum}</div>`;

                const players = document.createElement('div');
                players.className = 'match-players';

                const player1Name = pair.playerNames && pair.playerNames[0] ? pair.playerNames[0] : 'Unknown';
                const player2Name = pair.playerNames && pair.playerNames[1] ? pair.playerNames[1] : 'Unknown';

                const player1 = document.createElement('div');
                player1.className = 'match-player';
                player1.innerHTML = `
                    <div class="match-player-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24" fill="${color.border}">
                            <path d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM171.7 396.1C166 382 177.4 368 192.6 368L447.5 368C462.7 368 474.1 382 468.4 396.1C444.6 454.7 387.2 496 320.1 496C253 496 195.5 454.7 171.8 396.1zM186.7 207.3C191.2 200.5 200 198.1 207.3 201.8L286.9 241.8C292.3 244.5 295.7 250 295.7 256.1C295.7 262.2 292.3 267.7 286.9 270.4L207.3 310.4C200 314 191.2 311.7 186.7 304.9C182.2 298.1 183.6 289 189.8 283.8L223 256L189.8 228.3C183.6 223.1 182.2 214 186.7 207.2zM450.3 228.4L417 256L450.2 283.7C456.4 288.9 457.8 298 453.3 304.8C448.8 311.6 440 314 432.7 310.3L353.1 270.3C347.7 267.6 344.3 262.1 344.3 256C344.3 249.9 347.7 244.4 353.1 241.7L432.7 201.7C440 198.1 448.8 200.4 453.3 207.2C457.8 214 456.4 223.1 450.2 228.3z"/>
                        </svg>
                    </div>
                    <div class="match-player-name">${player1Name}</div>
                `;

                const vs = document.createElement('div');
                vs.className = 'vs-divider';
                vs.innerHTML = `<span class="vs-text">VS</span>`;

                const player2 = document.createElement('div');
                player2.className = 'match-player';
                player2.innerHTML = `
                    <div class="match-player-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="24" height="24" fill="${color.border}">
                            <path d="M320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM171.7 396.1C166 382 177.4 368 192.6 368L447.5 368C462.7 368 474.1 382 468.4 396.1C444.6 454.7 387.2 496 320.1 496C253 496 195.5 454.7 171.8 396.1zM186.7 207.3C191.2 200.5 200 198.1 207.3 201.8L286.9 241.8C292.3 244.5 295.7 250 295.7 256.1C295.7 262.2 292.3 267.7 286.9 270.4L207.3 310.4C200 314 191.2 311.7 186.7 304.9C182.2 298.1 183.6 289 189.8 283.8L223 256L189.8 228.3C183.6 223.1 182.2 214 186.7 207.2zM450.3 228.4L417 256L450.2 283.7C456.4 288.9 457.8 298 453.3 304.8C448.8 311.6 440 314 432.7 310.3L353.1 270.3C347.7 267.6 344.3 262.1 344.3 256C344.3 249.9 347.7 244.4 353.1 241.7L432.7 201.7C440 198.1 448.8 200.4 453.3 207.2C457.8 214 456.4 223.1 450.2 228.3z"/>
                        </svg>
                    </div>
                    <div class="match-player-name">${player2Name}</div>
                `;

                players.appendChild(player1);
                players.appendChild(vs);
                players.appendChild(player2);

                card.appendChild(header);
                card.appendChild(players);
                nextRoundContainer.appendChild(card);
            });
        }
    } else {
        if (nextRoundPairsSection) {
            nextRoundPairsSection.style.display = 'none';
        }
    }

    // Host kontrol√º - D√úZELTME: id kullan, userId deƒüil
    const isHost = data.winners && data.winners.some(player => player.id === currentUserId && player.isHost);

    console.log(`Host check - isHost: ${isHost}, currentUserId: ${currentUserId}`);

    // Butonlarƒ± ayarla - D√úZELTƒ∞LDƒ∞
    const roundWaitingBtn = document.getElementById('round-waiting-btn');
    const nextRoundBtn = document.getElementById('next-round-btn');
    const finalRoundBtn = document.getElementById('final-round-btn');

    // √ñnce t√ºm butonlarƒ± gizle
    if (roundWaitingBtn) roundWaitingBtn.style.display = 'none';
    if (nextRoundBtn) nextRoundBtn.style.display = 'none';
    if (finalRoundBtn) finalRoundBtn.style.display = 'none';

    if (isHost) {
        console.log('User is host, showing appropriate button');

        // Turnuva bitti mi kontrol et
        if (currentRound >= totalRounds) {
            console.log('Tournament completed');
            showNotification('üèÜ Turnuva tamamlandƒ±!', 'success');
        }
        // Final round mu?
        else if (nextRound === totalRounds) {
            console.log('Showing final round button');
            if (finalRoundBtn) {
                finalRoundBtn.style.display = 'block';
                finalRoundBtn.disabled = false;
            }
        }
        // Normal round
        else {
            console.log('Showing next round button');
            if (nextRoundBtn) {
                nextRoundBtn.style.display = 'block';
                nextRoundBtn.disabled = false;
            }
        }
    } else {
        console.log('User is not host, showing waiting button');
        if (roundWaitingBtn) {
            roundWaitingBtn.style.display = 'block';
            roundWaitingBtn.textContent = '‚è≥ Waiting for Host...';
        }
    }

    console.log('‚úÖ Round waiting room displayed successfully');
}

// Next Round butonuna event listener ekle
document.getElementById('next-round-btn').addEventListener('click', function() {
    this.disabled = true;
    this.innerHTML = '<div class="loading"></div> Starting Next Round...';

    roomSocket.send("start", {
        roomId: currentRoomId
    });

    showNotification('Sonraki round ba≈ülatƒ±lƒ±yor...', 'info');

    setTimeout(() => {
        if (this.disabled) {
            this.disabled = false;
            this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="20" height="20" fill="white" style="margin-right: 8px;"><path d="M544 160C544 124.7 515.3 96 480 96L160 96C124.7 96 96 124.7 96 160L96 480C96 515.3 124.7 544 160 544L480 544C515.3 544 544 515.3 544 480L544 160zM416 320C416 326.7 413.2 333 408.3 337.6L296.3 441.6C289.3 448.1 279.1 449.8 270.4 446C261.7 442.2 256 433.5 256 424L256 216C256 206.5 261.7 197.8 270.4 194C279.1 190.2 289.3 191.9 296.3 198.4L408.3 302.4C413.2 306.9 416 313.3 416 320z"/></svg><span>Start Next Round</span>';
        }
    }, 10000);
});

// Final Round butonuna event listener ekle
document.getElementById('final-round-btn').addEventListener('click', function() {
    this.disabled = true;
    this.innerHTML = '<div class="loading"></div> Starting Final Round...';

    roomSocket.send("start", {
        roomId: currentRoomId,
        round: tournamentData.currentRound + 1,
        isFinal: true
    });

    showNotification('üèÜ Final round ba≈ülatƒ±lƒ±yor!', 'success');

    setTimeout(() => {
        if (this.disabled) {
            this.disabled = false;
            this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="20" height="20" fill="white" style="margin-right: 8px;"><path d="M400 0L176 0c-26.5 0-48.1 21.8-47.1 48.2c.2 5.3 .4 10.6 .7 15.8L24 64C10.7 64 0 74.7 0 88c0 92.6 33.5 157 78.5 200.7c44.3 43.1 98.3 64.8 138.1 75.8c23.4 6.5 39.4 26 39.4 45.6c0 20.9-17 37.9-37.9 37.9L192 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-26.1 0C337 448 320 431 320 410.1c0-19.6 15.9-39.2 39.4-45.6c39.9-11 93.9-32.7 138.2-75.8C542.5 245 576 180.6 576 88c0-13.3-10.7-24-24-24L446.4 64c.3-5.2 .5-10.4 .7-15.8C448.1 21.8 426.5 0 400 0zM48.9 112l84.4 0c9.1 90.1 29.2 150.3 51.9 190.6c-24.9-11-50.8-26.5-73.2-48.3c-32-31.1-58-76-63-142.3zM464.1 254.3c-22.4 21.8-48.3 37.3-73.2 48.3c22.7-40.3 42.8-100.5 51.9-190.6l84.4 0c-5.1 66.3-31.1 111.2-63 142.3z"/></svg><span>Start Final Round</span>';
        }
    }, 10000);
});

// handleRoundFinished fonksiyonunu da g√ºncelle
function handleRoundFinished(payload) {
    console.log('üèÅ Round finished:', payload);

    // Payload kontrol√º
    if (!payload) {
        console.error('Invalid round data: payload is null');
        showNotification('Round verisi ge√ßersiz!', 'error');
        // returnToLobby();
        return;
    }

    // Round bilgilerini al
    const currentRound = payload.currentRound || 1;
    const maxRound = payload.maxRound || payload.totalRounds || 3;

    console.log(`Round finished - Current: ${currentRound}, Max: ${maxRound}`);

    // Kazananlarƒ± ve bir sonraki e≈üle≈ütirmeleri hazƒ±rla
    const winners = payload.players || payload.winners || [];
    const eliminated = payload.spectators || payload.eliminated || [];

    console.log(`Winners: ${winners.length}, Eliminated: ${eliminated.length}`);

    // Bir sonraki round'un e≈üle≈ütirmelerini hazƒ±rla
    let nextMatches = [];
    if (payload.match && Array.isArray(payload.match)) {
        nextMatches = payload.match.map((match, index) => {
            return {
                matchNumber: match.matchNumber !== undefined ? match.matchNumber : index,
                players: [match.player1.id, match.player2.id],
                playerNames: [match.player1.name, match.player2.name],
                winner: match.winner || null,
                loser: match.loser || null
            };
        });
    }

    console.log(`Next matches prepared: ${nextMatches.length}`);

    // Round verilerini sakla
    tournamentData = {
        currentRound: currentRound,
        totalRounds: maxRound,
        maxRound: maxRound,  // Her ikisini de sakla
        winners: winners,
        eliminated: eliminated,
        nextMatches: nextMatches
    };

    console.log('Tournament data updated:', tournamentData);

    // Round arasƒ± bekleme odasƒ±nƒ± g√∂ster
    showRoundWaitingRoom(tournamentData);

    showNotification(`Round ${currentRound} tamamlandƒ±!`, 'success');
}

// returnToLobby fonksiyonu ekle
// function returnToLobby() {
//     console.log('üè† Returning to lobby');

//     // T√ºm odalarƒ± gizle
//     document.querySelectorAll('.waiting-room').forEach(room => room.classList.remove('active'));

//     // Game page'i g√∂ster
//     document.getElementById('game-page').classList.remove('hidden');

//     // Back arrow'u gizle
//     const backArrow = document.getElementById('back-arrow');
//     if (backArrow) {
//         backArrow.classList.remove('active');
//     }

//     // Room state'i sƒ±fƒ±rla
//     currentRoomId = null;
//     currentGameMode = null;

//     // Tournament data'yƒ± sƒ±fƒ±rla
//     tournamentData = {
//         currentRound: 0,
//         totalRounds: 0,
//         winners: [],
//         nextMatches: []
//     };
// }

// Back arrow'a round waiting room i√ßin de destek ekle
document.getElementById('back-arrow').addEventListener('click', function() {
    // Leave room if in one
    if (currentRoomId) {
        roomSocket.send("leave", { roomId: currentRoomId });
    }

    // Lobiye d√∂n
    // returnToLobby();
    showNotification('Odadan ayrƒ±ldƒ±nƒ±z', 'info');
});

</script>
</body>
</html>
